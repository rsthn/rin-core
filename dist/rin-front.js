parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"DqrR":[function(require,module,exports) {
let e=module.exports={};e.invokeLater=function(e){e&&setTimeout(function(){e()},10)},e.typeOf=function(e){return e instanceof Array?"array":null===e?"null":(typeof e).toString().toLowerCase()},e.isArrayOrObject=function(r){switch(e.typeOf(r)){case"array":case"object":return!0}return!1},e.clone=function(r){var t;if("array"==e.typeOf(r)){t=[];for(let n=0;n<r.length;n++)t.push(e.clone(r[n]))}else if("object"==e.typeOf(r)){t={};for(let n in r)t[n]=e.clone(r[n])}else t=r;return t},e.merge=function(r,...t){if("array"==e.typeOf(r))for(let n=0;n<t.length;n++){let i=t[n];if("array"!=e.typeOf(i))r.push(i);else for(let t=0;t<i.length;t++)r.push(e.clone(i[t]))}else if("object"==e.typeOf(r))for(let n=0;n<t.length;n++){let i=t[n];if("object"==e.typeOf(i))for(let t in i)e.isArrayOrObject(i[t])?t in r?e.merge(r[t],i[t]):r[t]=e.clone(i[t]):r[t]=i[t]}return r},e.override=function(e,...r){for(let t=0;t<r.length;t++)for(let n in r[t])e[n]=r[t][n];return e},e.partialCompare=function(e,r){if(null==e||null==r)return!1;if(e===r)return!0;for(var t in r)if(e[t]!=r[t])return!1;return!0},e.arrayFind=function(e,r,t){for(var n=0;e&&n<e.length;n++)if(this.partialCompare(e[n],r))return t?e[n]:n;return!!t&&null},e.indexOf=function(e,r){for(let t in e)if(e[t]==r)return t;return-1},e.escape=function(e){return(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},e.ensureTypeOf=function(e,r){return!r||!e||r instanceof e?r:r.isInstanceOf&&e.prototype.className&&r.isInstanceOf(e.prototype.className)?r:new e(r)},e.serialize=function(e){return JSON.stringify(e)},e.deserialize=function(e){return JSON.parse(e)};
},{}],"voWE":[function(require,module,exports) {
let s=require("./alpha");module.exports=Class=function(){},Class._class=Class,Class._super={},Class.prototype.className="Class",Class.prototype.__ctor=function(){},Class.prototype.__dtor=function(){},Class.prototype.isInstanceOf=function(t){return(t="string"==s.typeOf(t)?t:t.prototype?t.prototype.className:t.constructor.prototype.className)in this._super||this.className==t},Class.prototype._initSuperRefs=function(){var t=this.constructor._super,e={};for(let r in t){let o={},p=t[r].prototype;for(let t in p)"function"==s.typeOf(p[t])&&(o[t]=p[t].bind(this));e[r]=o}this._super=e},Class.inherit=function(t){var e=this._class,r=e._super,o=e._class;if("function"==s.typeOf(t)){for(let s in t._class)/^[A-Z]/.test(s)||(e[s]=t._class[s]);s.override(e.prototype,t._class.prototype),s.override(r,t._class._super),t._class.prototype.className&&(r[t._class.prototype.className]=t._class)}else s.override(e.prototype,t);return e._super=r,e._class=o,e},Class.prototype._extend=function(s,t){var e=function(...s){this._initSuperRefs(),this.__ctor.apply(this,s)};e._class=e,e._super={},Class.inherit.call(e,s),delete e.prototype.className;for(let r=0;r<t.length;r++)e.inherit(t[r]);return delete e._super.Class,"classInit"in e.prototype&&e.prototype.classInit(),e},Class.extend=function(...s){return this._class.prototype._extend(this,s)},Class.create=function(s){return new(this.extend(s))};
},{"./alpha":"DqrR"}],"C33R":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3];let i=require("./alpha"),s=require("./class");module.exports=s.extend({className:"Event",source:null,name:null,args:null,_async:!1,list:null,next:null,ret:null,original:null,i:-1,__ctor:function(t,i,s,h,n,e){this.source=t,this.name=s,this.args=h,this.cbHandler=n,this.cbContext=e,this.list=i,this.reset()},reset:function(){return this.next=null,this.ret=[],this._async=!1,this.i=-1,this},wait:function(){return this._async=!0,this},resume:function(){for(this._async=!1;!(this._async||++this.i>=this.list.length);)if(!this.list[this.i].silent)if("string"==i.typeOf(this.list[this.i].handler)){if(this.list[this.i].context){if(!this.list[this.i].context[this.list[this.i].handler])continue;if(!1===this.list[this.i].context[this.list[this.i].handler](this,this.args,this.list[this.i].data))break}else if(!1===t[this.list[this.i].handler].call(null,this,this.args,this.list[this.i].data))break}else if(!1===this.list[this.i].handler.call(this.list[this.i].context,this,this.args,this.list[this.i].data))break;return this._async?this:(this.i>=this.list.length&&this.next&&this.next.resume(),this.cbHandler&&this.cbHandler.call(this.cbContext),this)},from:function(t){return this.original=t,this},enqueue:function(t){if(!t)return this;var i;for(i=this;null!=i.next;i=i.next);return i.next=t,t.from(this),this}});
},{"./alpha":"DqrR","./class":"voWE"}],"xxCV":[function(require,module,exports) {
let e=require("./class"),t=require("./event");module.exports=e.extend({className:"EventDispatcher",listeners:null,__ctor:function(){this.listeners={}},addEventListener:function(e,t,s,n){var i=(e=e.split(":"))[e.length-1],r=e.length>1?e[0]:null;return this.listeners[i]||(this.listeners[i]=[]),this.listeners[i].push({ns:r,handler:t,context:s,data:n,silent:0}),this},removeEventListener:function(e,t,s){var n=(e=e.split(":"))[e.length-1],i=e.length>1?e[0]:null;if("*"==n)for(var r in this.listeners)for(var l=this.listeners[r],h=0;h<l.length;h++){var a=!0;t&&(a=a&&l[h].handler===t),s&&(a=a&&l[h].context===s),i&&(a=a&&l[h].ns==i),a&&l.splice(h--,1)}else{if(!this.listeners[n])return this;for(l=this.listeners[n],h=0;h<l.length;h++){a=!0;t&&(a=a&&l[h].handler===t),s&&(a=a&&l[h].context===s),i&&(a=a&&l[h].ns==i),a&&l.splice(h--,1)}}return this},prepareEvent:function(e,s,n,i){var r=[],l=(e=e.split(":"))[e.length-1],h=e.length>1?e[0]:null;this.listeners[l]&&(r=r.concat(this.listeners[l])),this.listeners["*"]&&(r=r.concat(this.listeners["*"]));for(var a=0;a<r.length;a++)r[a].silent&&r.splice(a--,1);if(h)for(a=0;a<r.length;a++)r[a].ns!=h&&r.splice(a--,1);return new t(this,r,l,s,n,i)},silence:function(e,t){var s=(e=e.split(":"))[e.length-1],n=e.length>1?e[0]:null;if(t=!1===t?-1:1,"*"==s)for(var i in this.listeners)for(var r=this.listeners[i],l=0;l<r.length;l++)n&&r[l].ns!=n||(r[l].silent+=t);else{if(!this.listeners[s])return this;for(r=this.listeners[s],l=0;l<r.length;l++)n&&r[l].ns!=n||(r[l].silent+=t)}return this},dispatchEvent:function(e,t,s,n){return this.prepareEvent(e,t,s,n).resume()}});
},{"./class":"voWE","./event":"C33R"}],"u2gq":[function(require,module,exports) {
module.exports={email:/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)+$/i,url:/^[\w-]+:\/\/[\w-]+(\.\w+)+.*$/,urlNoProt:/^[\w-]+(\.\w+)+.*$/,name:/^[-A-Za-z0-9_.]+$/,uname:/^['\pL\pN ]+$/,text:/^[^&<>{}]*$/,utext:/^([\r\n\pL\pN\pS &!@#$%*\[\]()_+=;',.\/?:"~-]+)$/};
},{}],"eGc5":[function(require,module,exports) {
let Rin=require("./alpha"),Regex=require("./model-regex");module.exports={_getref:function(value,obj){return"string"==typeof value?("#"==value.substr(0,1)?value=obj.get(value.substr(1)):"@"==value.substr(0,1)&&(value=obj[value.substr(1)]),"string"==typeof value?eval(value):value):value},type:function(r,e,t,n){switch(e){case"int":if(n=parseInt(n),isNaN(n))throw new Error(e);break;case"float":if(n=parseFloat(n),isNaN(n))throw new Error(e);break;case"string":n=null==n?"":n.toString();break;case"bit":if(!0===n||!1===n){n=n?1:0;break}if(n=parseInt(n),isNaN(n))throw new Error(e);n=n?1:0;break;case"array":if("array"==Rin.typeOf(n))break;if(null==n){n=[];break}throw new Error(e);case"bool":if("true"===n||!0===n){n=!0;break}if("false"===n||!1===n){n=!1;break}throw new Error(e)}return n},model:function(r,e,t,n){var o=this._getref(e,r);if(!o)throw new Error(e);return n?o.ensure(n):new o},cls:function(r,e,t,n){var o=this._getref(e,r);return n?Rin.ensureTypeOf(o,n):new o},arrayof:function(r,e,t,n){var o=this._getref(e,r);if(n||(n=[]),!o||"array"!=Rin.typeOf(n))throw new Error(e);for(var i=0;i<n.length;i++)n[i]=Rin.ensureTypeOf(o,n[i]);return n},arraynull:function(r,e,t,n){var o=!1;if("object"==Rin.typeOf(e)&&(e.remove&&(o=e.remove),e=e.value),e)return n;if("array"!=Rin.typeOf(n))throw new Error(e);for(var i=0;i<n.length;i++)if(null==n[i]){if(!o)throw new Error(e);n.splice(i--,1)}return n},arraycompliant:function(r,e,t,n){var o=!1;if("object"==Rin.typeOf(e)&&(e.remove&&(o=e.remove),e=e.value),!e)return n;if("array"!=Rin.typeOf(n))throw new Error(e);for(var i=0;i<n.length;i++)if(null!=n[i]&&!n[i].isCompliant()){if(!o)throw new Error(e);n.splice(i--,1)}return n},required:function(r,e,t,n){if(null==n)throw new Error(e?"":"null");switch(Rin.typeOf(n)){case"array":if(0==n.length)throw new Error(e?"":"null");break;default:if(0==n.toString().length)throw new Error(e?"":"null")}return n},minlen:function(r,e,t,n){if(n.toString().length<e)throw new Error(e);return n},maxlen:function(r,e,t,n){if(n.toString().length>e)throw new Error(e);return n},minval:function(r,e,t,n){if(parseFloat(n)<e)throw new Error(e);return n},maxval:function(r,e,t,n){if(parseFloat(n)>e)throw new Error(e);return n},mincount:function(r,e,t,n){if("array"!=Rin.typeOf(n)||n.length<e)throw new Error(e);return n},maxcount:function(r,e,t,n){if("array"!=Rin.typeOf(n)||n.length>e)throw new Error(e);return n},pattern:function(r,e,t,n){if(!Regex[e].test(n.toString()))throw new Error(e);return n},inset:function(r,e,t,n){if("array"!=Rin.typeOf(e)){if(!new RegExp("^("+e.toString()+")$").test(n.toString()))throw new Error(e);return n}if(-1==e.indexOf(n.toString()))throw new Error(e.join("|"));return n},upper:function(r,e,t,n){return e?n.toString().toUpperCase():n},lower:function(r,e,t,n){return e?n.toString().toLowerCase():n}};
},{"./alpha":"DqrR","./model-regex":"u2gq"}],"UP3c":[function(require,module,exports) {
let t=require("./alpha"),i=require("./event-dispatcher"),s=module.exports=i.extend({className:"Model",defaults:null,constraints:null,data:null,changedList:null,_silent:0,_level:0,__ctor:function(t,i){if(this._super.EventDispatcher.__ctor(),this.data={},null!=i)this.reset(i);else{var s=null;if(!this.defaults&&this.constraints){s={};for(var e in this.constraints){var n=this.constraints[e];null!==n.def&&void 0!==n.def?"function"==typeof n.def?s[e]=n.def():s[e]=n.def:s[e]=null}}this.reset(s)}this.init(),null!=t&&this.set(arguments[0],!0),this.constraints&&this.update(),this.ready()},reset:function(i,s){if(!this.defaults){if(!i||"object"!=t.typeOf(i)&&"function"!=t.typeOf(i))return this;this.defaults=i}return"function"==t.typeOf(this.defaults)?this.data=this.defaults():this.data=t.clone(this.defaults),!1===s||!1===i?this:this.update(null,!0)},init:function(){},ready:function(){},silent:function(t){return this._silent+=t?1:-1,this},_validate:function(t,i){if(!this.constraints||!this.constraints[t])return i;var e=this.constraints[t],n=i;for(var a in e)if(s.Constraints[a])try{n=s.Constraints[a](this,e[a],t,n)}catch(r){if("null"==r.message)break;throw new Error(`Constraint [${a}:${e[a]}] failed on property '${t}'.`)}return n},_set:function(t,i){if(!this.constraints||!this.constraints[t])return this.data[t]=i,i;var e=this.constraints[t],n=(this.data[t],i);for(var a in e)if(s.Constraints[a])try{n=s.Constraints[a](this,e[a],t,n)}catch(r){if("null"==r.message)break;this._silent||this.dispatchEvent("constraintError",{constraint:a,message:r.message,name:t,value:i});break}return this.data[t]=n},_propertyEvent:function(t,i,s,e){var n={name:t,old:i,value:s,level:this._level},a=this.dispatchEvent("propertyChanging",n);e?this.data[t]=n.value:n.value=this._set(t,n.value),null!=a&&a.ret.length&&!1===a.ret[0]||(this.dispatchEvent("propertyChanged."+t,n),this.dispatchEvent("propertyChanged",n),this.changedList.push(t))},set:function(){var i=arguments.length,s=!1,e=!1;if((i>2||2==i&&"object"==t.typeOf(arguments[0]))&&"boolean"==t.typeOf(arguments[i-1])&&!1===(s=arguments[--i])&&(e=!0),0==this._level&&(this.changedList=[]),this._level++,2==i)(this.data[arguments[0]]!=arguments[1]||s)&&(this._silent||e?this._set(arguments[0],arguments[1]):this._propertyEvent(arguments[0],this.data[arguments[0]],this._validate(arguments[0],arguments[1])));else for(var n in arguments[0])(this.data[n]!=arguments[0][n]||s)&&(this._silent||e?this._set(n,arguments[0][n]):this._propertyEvent(n,this.data[n],this._validate(n,arguments[0][n])));return--this._level||!this.changedList.length||e||this._silent||this.dispatchEvent("modelChanged",{fields:this.changedList}),this},get:function(t,i){return 0==arguments.length||!1===t?this.data:1==arguments.length&&!0===t?this.flatten():2==arguments.length&&void 0===this.data[t]?i:this.data[t]},getInt:function(t,i){return 2==arguments.length&&void 0===this.data[t]?i:parseInt(this.data[t])},getFloat:function(t,i){return 2==arguments.length&&void 0===this.data[t]?i:parseFloat(this.data[t])},getBool:function(t,i){return"true"===(t=2==arguments.length&&void 0===this.data[t]?i:this.data[t])||!0===t||"false"!==t&&!1!==t&&!!parseInt(t)},getReference:function(t){var i=this;return{get:function(){return i.get(t)},set:function(s){i.set(t,s)}}},constraint:function(i,s,e){if(3==arguments.length||2==arguments.length||1==arguments.length&&"object"==t.typeOf(i)){switch(this.constraints===this.constructor.prototype.constraints&&(this.constraints=t.clone(this.constraints)),arguments.length){case 1:t.override(this.constraints,i);break;case 2:t.override(this.constraints[i],s);break;case 3:this.constraints[i][s]=e}return this}return i?this.constraints[i]:this},flatten:function(i,s){if(i)return null==(a=this.flatten(!1,!0))?null:(a.class=this.classPath,a);if(!this.constraints&&!this.defaults)return this.data;if(!this.isCompliant())return{};var e=this.constraints,n=this.defaults?"function"==t.typeOf(this.defaults)?this.defaults():this.defaults:this.constraints,a={};for(var r in this.data)if(r in n){if(e&&e[r]){var h=e[r];if(h.model){a[r]=this.data[r]?this.data[r].flatten(s):null;continue}if(h.arrayof){a[r]=[];for(var l=0;l<this.data[r].length;l++)a[r][l]=this.data[r][l]?this.data[r][l].flatten(s):null;continue}if(h.cls){a[r]=this.data[r]?this.data[r].flatten():null;continue}}a[r]=this.data[r]}return a},remove:function(i,s){if("array"==t.typeOf(i)){for(var e=0;e<i.length;e++)delete this.data[i[e]];!1===s||this._silent||this.dispatchEvent("propertyRemoved",{fields:i})}else delete this.data[i],!1===s||this._silent||this.dispatchEvent("propertyRemoved",{fields:[i]})},update:function(i,s){if(this._silent)return this;if(0==this._level&&(this.changedList=[]),this._level++,i&&"string"==t.typeOf(i))this._propertyEvent(i,this.data[i],this.data[i],s);else if(i)for(var e of i)this._propertyEvent(e,this.data[e],this.data[e],s);else for(var e in this.data)this._propertyEvent(e,this.data[e],this.data[e],s);return--this._level||!this.changedList.length||this._silent||this.dispatchEvent("modelChanged",{fields:this.changedList}),this},validate:function(i){if(!this.constraints)return this;if(i&&"string"==t.typeOf(i))this._set(i,this.data[i]);else for(var s in this.data)i&&-1==t.indexOf(i,s)||this._set(s,this.data[s]);return this},isCompliant:function(){if(!this.constraints)return!0;try{for(var t in this.data)this._validate(t,this.data[t]);return!0}catch(i){}return!1},observe:function(t,i,s){this.addEventListener("propertyChanged."+t,i,s)},unobserve:function(t,i,s){this.removeEventListener("propertyChanged."+t,i,s)},toString:function(){return t.serialize(this.get(!0))}});s.Constraints=require("./model-constraints");
},{"./alpha":"DqrR","./event-dispatcher":"xxCV","./model-constraints":"eGc5"}],"OJpq":[function(require,module,exports) {
let e=require("./alpha"),t=require("./model");module.exports=t.extend({className:"List",itemt:t,contents:null,defaults:{contents:null},constraints:{contents:{type:"array",arrayof:"@itemt"}},ready:function(){this._eventGroup="ModelList_"+Date.now()+":modelChanged",this.contents=this.data.contents},_bind:function(e,t){return t&&t.addEventListener&&t.addEventListener(this._eventGroup,this._onItemEvent,this,e),t},_unbind:function(e){return e&&e.removeEventListener&&e.removeEventListener(this._eventGroup),e},_onItemEvent:function(e,t,n){this.prepareEvent("itemChanged",{index:n,item:e.source}).from(e).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume()},count:function(){return this.data.contents.length},clear:function(){for(var e=0;e<this.data.contents;e++)this._unbind(this.data.contents[e]);this.data.contents=[],this.prepareEvent("itemCleared").enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume()},setData:function(t){if(this.clear(),t){for(var n=0;n<t.length;n++){var i=e.ensureTypeOf(this.itemt,t[n]);this._bind(n,i),this.data.contents.push(i)}this.prepareEvent("itemsChanged").enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume()}},getData:function(){return this.data.contents},getAt:function(t){return t<0||t>=this.data.contents.length?null:e.ensureTypeOf(this.itemt,this.data.contents[t])},removeAt:function(t){if(t<0||t>=this.data.contents.length)return null;var n=e.ensureTypeOf(this.itemt,this.data.contents.splice(t,1)[0]);return this._unbind(n),this.prepareEvent("itemRemoved",{index:t,item:n}).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),n},setAt:function(t,n){return!(t<0||t>=this.data.contents.length)&&(n=e.ensureTypeOf(this.itemt,n),this.data.contents[t]=n,this._bind(t,n),this.prepareEvent("itemChanged",{index:t,item:n}).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),!0)},updateAt:function(e){return!(e<0||e>=this.data.contents.length)&&(this.prepareEvent("itemChanged",{index:e,item:this.data.contents[e]}).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),!0)},push:function(t){return t&&"object"!=e.typeOf(t)?null:(t=e.ensureTypeOf(this.itemt,t),this.data.contents.push(t),this._bind(this.data.contents.length-1,t),this.prepareEvent("itemAdded",{index:this.data.contents.length-1,item:t}).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),t)},pop:function(){return this._unbind(e.ensureTypeOf(this.itemt,this.data.contents.pop()))},unshift:function(t){return t&&"object"!=e.typeOf(t)?null:(t=e.ensureTypeOf(this.itemt,t),this.data.contents.unshift(t),this._bind(0,t),this.prepareEvent("itemAdded",{index:0,item:t}).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),t)},shift:function(){return this._unbind(e.ensureTypeOf(this.itemt,this.data.contents.shift()))},find:function(t,n){for(var i=this.data.contents,s=0;s<i.length;s++)if(e.partialCompare(i[s].data,t))return n?i[s]:s;return n?null:-1}});
},{"./alpha":"DqrR","./model":"UP3c"}],"z45J":[function(require,module,exports) {
let t=require("./alpha"),n=module.exports={Type:function(n){let e={flatten:function(t,n){return t},unflatten:function(t,n){return t}};return n?t.override(e,n):e},String:function(){return n.Type({flatten:function(t,n){return null!=t?t.toString():null},unflatten:function(t,n){return null!=t?t.toString():null}})},Integer:function(){return n.Type({flatten:function(t,n){return~~t},unflatten:function(t,n){return~~t}})},Number:function(t){return n.Type({_precision:t,_round:!1,precision:function(t){return this._precision=~~t,this},flatten:function(t,n){return t=parseFloat(t),this._precision>0&&(t=~~(t*Math.pow(10,this._precision))/Math.pow(10,this._precision)),t},unflatten:function(t,n){return parseFloat(t)}})},Bool:function(t){return n.Type({_compact:t,compact:function(t){return this._compact=t,this},flatten:function(t,n){return t=~~t,this._compact?t>0?1:0:t>0},unflatten:function(t,n){return!!~~t}})},SharedString:function(){return n.Type({flatten:function(t,n){return null==t?0:(t=t.toString(),"strings"in n||(n.strings_map={},n.strings=[]),t in n.strings_map||(n.strings.push(t),n.strings_map[t]=n.strings.length),n.strings_map[t])},unflatten:function(t,n){return null==t||0==t?null:n.strings[~~t-1]}})},Array:function(t){return n.Type({itemType:t,_debug:!1,debug:function(t){return this._debug=t,this},of:function(t){return this.itemType=t,this},flatten:function(t,n){if(null==t)return null;let e=[];for(let r=0;r<t.length;r++)e.push(this.itemType.flatten(t[r],n));return e},unflatten:async function(t,n){if(null==t)return null;let e=[];for(let r=0;r<t.length;r++)e.push(await this.itemType.unflatten(t[r],n));return e}})},Object:function(){return n.Type({properties:[],property:function(t,n){return this.properties.push({name:t,type:n}),this},flatten:function(t,n){if(null==t)return null;let e;if(!0===n.symbolic){e={};for(let r=0;r<this.properties.length;r++)e[this.properties[r].name]=this.properties[r].type.flatten(t[this.properties[r].name],n)}else{e=[];for(let r=0;r<this.properties.length;r++)e.push(this.properties[r].type.flatten(t[this.properties[r].name],n))}return e},unflatten:async function(t,n){if(null==t)return null;let e={};if(!0===n.symbolic)for(let r=0;r<this.properties.length;r++)e[this.properties[r].name]=await this.properties[r].type.unflatten(t[this.properties[r].name],n);else for(let r=0;r<this.properties.length;r++)e[this.properties[r].name]=await this.properties[r].type.unflatten(t[r],n);return e}})},Class:function(t){return n.Type({_constructor:t,constructor:function(t){return this._constructor=t,this},flatten:function(t,n){return null==t?null:t.flatten(n)},unflatten:async function(t,n){return null==t?null:await(new this._constructor).unflatten(t,n)}})},Property:function(t,e){return n.Type({property:t,type:e,name:function(t){return this.property=t,this},is:function(t){return this.type=t,this},flatten:function(t,n){if(null==t)return null;let e;return!0===n.symbolic?(e={})[this.property]=this.type.flatten(t[this.property],n):e=this.type.flatten(t[this.property],n),e},unflatten:async function(t,n){if(null==t)return null;let e={};return!0===n.symbolic?e[this.property]=await this.type.unflatten(t[this.property],n):e[this.property]=await this.type.unflatten(t,n),e}})},Map:function(){return n.Type({flatten:function(t,n){if(null==t)return null;if(!0===n.symbolic)return t;let e=[];for(let r in t)e.push(r),e.push(t[r]);return e},unflatten:function(t,n){if(null==t)return null;if(!0===n.symbolic)return t;let e={};for(let r=0;r<t.length;r+=2)e[t[r]]=t[r+1];return e}})}};
},{"./alpha":"DqrR"}],"gwLi":[function(require,module,exports) {
let t=require("./class");module.exports=t.extend({className:"Flattenable",typeSchema:null,flatten:function(t){return this.typeSchema.flatten(this,t)},unflatten:async function(t,e){return Object.assign(this,await this.typeSchema.unflatten(t,e)),await this.onUnflattened(),this},onUnflattened:async function(){}});
},{"./class":"voWE"}],"ZP4A":[function(require,module,exports) {
let t=require("./flattenable"),i=require("./schema"),e=require("./alpha");module.exports=t.extend({className:"Collection",itemTypeSchema:null,items:null,__ctor:function(t){t||(t=this.itemTypeSchema),t&&(this.typeSchema=i.Property("items").is(i.Array().of(t))),this.reset()},onUnflattened:function(){let t=this.items;this.reset();for(let i of t)this.add(i)},reset:function(){return this.items=[],this},clear:function(){var t=this.items;this.reset();for(var i=0;i<t.length;i++)this.onItemRemoved(t[i],0);return this},sort:function(t,i){return"function"!=typeof t?this.items.sort(function(e,s){return(e[t]<=s[t]?-1:1)*(!0===i?-1:1)}):this.items.sort(t),this},findItem:function(t,i){if(!this.items)return null;for(var s=0;s<this.items.length;s++)if((!i||!e.partialCompare(this.items[s],i))&&e.partialCompare(this.items[s],t))return this.items[s];return null},getItems:function(){return this.items},count:function(){return this.items.length},isEmpty:function(){return!this.items.length},add:function(t){return t&&this.onBeforeItemAdded(t)?(this.items.push(t),this.onItemAdded(t),this):this},addAt:function(t,i){if(!i||!this.onBeforeItemAdded(i))return this;if(t<0&&(t=0),t>this.items.length&&(t=this.items.length),0==t)this.items.unshift(i);else if(t==this.items.length)this.items.push(i);else{var e=this.items.splice(0,t);e.push(i),this.items=e.concat(this.items)}return this.onItemAdded(i),this},addItems:function(t){if(!t)return this;for(var i=0;i<t.length;i++)this.add(t[i]);return this},indexOf:function(t){return this.items.indexOf(t)},getAt:function(t,i){return t<0&&1==i&&(t+=this.items.length),t>=0&&t<this.items.length?this.items[t]:null},removeAt:function(t){if(t<0||t>=this.items.length)return this;var i=this.items[t];return this.items.splice(t,1),this.onItemRemoved(i,t),this},remove:function(t){this.removeAt(this.indexOf(t))},forEach:function(t){if(this.isEmpty())return this;for(var i=0;i<this.items.length&&!1!==t(this.items[i],i,this);i++);return this},forEachCall:function(t,...i){if(this.isEmpty())return this;for(var e=0;e<this.items.length&&!1!==this.items[e][t](...i);e++);return this},forEachRev:function(t){if(this.isEmpty())return this;for(var i=this.items.length-1;i>=0&&!1!==t(this.items[i],i,this);i--);return this},forEachRevCall:function(t,...i){if(this.isEmpty())return this;for(var e=this.items.length-1;e>=0&&!1!==this.items[e][t](...i);e--);return this},onBeforeItemAdded:function(t){return!0},onItemAdded:function(t){},onItemRemoved:function(t){}});
},{"./flattenable":"gwLi","./schema":"z45J","./alpha":"DqrR"}],"iJ0q":[function(require,module,exports) {
let e=require("./alpha"),t=module.exports={strict:!1,parseTemplate:function(r,n,a,l=!1,f=1){let s="string",o=null,u=0,p=0,c="",g=[],h=g,d=!1;function b(r,i){if("template"==r?i=t.parseTemplate(i,n,a,!0,0):"parse"==r?(i=t.parseTemplate(i,n,a,!1,0),r="base-string","array"==e.typeOf(i)&&(r=i[0].type,i=i[0].data)):"parse-trim-merge"==r?i=t.parseTemplate(i.trim().split("\n").map(e=>e.trim()).join("\n"),n,a,!1,0):"parse-merge"==r?i=t.parseTemplate(i,n,a,!1,0):"parse-merge-alt"==r&&(i=t.parseTemplate(i,"{","}",!1,0)),"parse-merge"==r||"parse-merge-alt"==r||"parse-trim-merge"==r)for(let e=0;e<i.length;e++)g.push(i[e]);else g.push({type:r,data:i});d&&(h.push(g=[]),d=!1)}!0===l&&(r=r.trim(),s="identifier",u=10,h.push(g=[])),r+="\0";for(let e=0;e<r.length;e++)if("\\"!=r[e]){switch(u){case 0:"\0"==r[e]?o="string":r[e]==n&&"<"==r[e+1]?(u=1,p=1,o="string",s="parse-merge"):r[e]==n&&"@"==r[e+1]?(u=1,p=1,o="string",s="parse-trim-merge",e++):r[e]==n&&":"==r[e+1]?(u=12,p=1,o="string",s="string",e++):r[e]==n?(u=1,p=1,o="string",s="template"):c+=r[e];break;case 1:if("\0"==r[e])throw new Error("Parse error: Unexpected end of template");if(r[e]==a){if(--p<0)throw new Error("Parse error: Unmatched "+a);if(0==p){u=0,o=s;break}}else r[e]==n&&p++;c+=r[e];break;case 10:if("\0"==r[e]){o=s;break}if("."==r[e]){b(s,c),b("access","."),s="identifier",c="";break}if(null!=r[e].match(/[\t\n\r\f\v ]/)){for(o=s,s="identifier",d=!0;null!=r[e].match(/[\t\n\r\f\v ]/);)e++;e--;break}if(r[e]==n&&"<"==r[e+1]){c&&(o=s),u=11,p=1,s="parse-merge";break}if(r[e]==n&&"@"==r[e+1]){c&&(o=s),u=11,p=1,s="parse-trim-merge",e++;break}if('"'==r[e]){c&&(o=s),u=14,p=1,s="parse-merge";break}if("'"==r[e]){c&&(o=s),u=15,p=1,s="parse-merge";break}if("`"==r[e]){c&&(o=s),u=16,p=1,s="parse-merge-alt";break}if(r[e]==n&&":"==r[e+1]){c&&(o=s),u=13,p=1,s="string",e++;break}if(r[e]==n){c&&b(s,c),u=11,p=1,c="",s="parse",c+=r[e];break}"identifier"!=s&&(b(s,c),c="",s="identifier"),c+=r[e];break;case 11:if("\0"==r[e])throw new Error("Parse error: Unexpected end of template");if(r[e]==a){if(--p<0)throw new Error("Parse error: Unmatched "+a);if(0==p&&(u=10,"parse-merge"==s||"parse-merge-alt"==s||"parse-trim-merge"==s))break}else r[e]==n&&p++;c+=r[e];break;case 12:if("\0"==r[e])throw new Error("Parse error: Unexpected end of template");if(r[e]==a){if(--p<0)throw new Error("Parse error: Unmatched "+a);if(0==p){0!=c.length&&"<"!=c[0]&&"["!=c[0]&&" "!=c[0]&&(c=n+c+a),u=0,o=s;break}}else r[e]==n&&p++;c+=r[e];break;case 13:if("\0"==r[e])throw new Error("Parse error: Unexpected end of template");if(r[e]==a){if(--p<0)throw new Error("Parse error: Unmatched "+a);if(0==p){"<"!=c[0]&&"["!=c[0]&&" "!=c[0]&&(c=n+c+a),u=10;break}}else r[e]==n&&p++;c+=r[e];break;case 14:if("\0"==r[e])throw new Error("Parse error: Unexpected end of template");if('"'==r[e]){if(--p<0)throw new Error('Parse error: Unmatched "');if(0==p&&(u=10,"parse-merge"==s||"parse-merge-alt"==s||"parse-trim-merge"==s))break}c+=r[e];break;case 15:if("\0"==r[e])throw new Error("Parse error: Unexpected end of template");if("'"==r[e]){if(--p<0)throw new Error("Parse error: Unmatched '");if(0==p&&(u=10,"parse-merge"==s||"parse-merge-alt"==s||"parse-trim-merge"==s))break}c+=r[e];break;case 16:if("\0"==r[e])throw new Error("Parse error: Unexpected end of template");if("`"==r[e]){if(--p<0)throw new Error("Parse error: Unmatched `");if(0==p&&(u=10,"parse-merge"==s||"parse-merge-alt"==s||"parse-trim-merge"==s))break}c+=r[e]}o&&(b(o,c),o=c="")}else c+="\\",c+=r[++e];if(!l){for(i=0;i<h.length&&"string"==h[i].type&&""==h[i].data;)h.splice(i,1);for(i=h.length-1;i>0&&"string"==h[i].type&&""==h[i].data;)h.splice(i--,1);0==h.length&&h.push({type:"string",data:""})}return f&&function e(t){if("object"==typeof t){if(t instanceof Array)for(let r=0;r<t.length;r++)e(t[r]);else t.data=e(t.data);return t}for(let r=0;r<t.length;r++)if("\\"==t[r]){let e=t[r+1];switch(e){case"n":e="\n";break;case"r":e="\r";break;case"f":e="\f";break;case"v":e="\v";break;case"t":e="\t";break;case"s":e="s";break;case'"':e='"';break;case"'":e="'"}t=t.substr(0,r)+e+t.substr(r+2)}return t}(h),h},parse:function(e){return this.parseTemplate(e.trim(),"[","]",!1)},expand:function(r,n,a="text",i="base-string"){let l=[];if("var"==i){let e=!0,a=!1,i=n,f=null,s=!0,o="";for(let l=0;l<r.length&&null!=n;l++)switch(r[l].type){case"identifier":case"string":o+=r[l].data,f=null;break;case"template":o+="object"!=typeof(f=this.expand(r[l].data,i,"arg","template"))?f:"";break;case"base-string":o+=this.expand(r[l].data,i,"arg","base-string"),f=null;break;case"access":if(f&&"object"==typeof f)n=f;else{for(o||(o="this");;)if("!"==o[0])o=o.substr(1),e=!1;else{if("$"!=o[0])break;o=o.substr(1),a=!0}if("this"!=o&&null!=n){let e=n;null===(n=o in n?n[o]:null)&&s&&o in t.functions&&(n=t.functions[o](null,null,e)),s=!1}}o=""}for(;""!=o;)if("!"==o[0])o=o.substr(1),e=!1;else{if("$"!=o[0])break;o=o.substr(1),a=!0}if("this"!=o){let e=!1;if(null!=n?o in n?n=n[o]:(e=!0,n=null):e=!0,e&&1==r.length&&1==t.strict)throw new Error("Expression function `"+o+"` not found.")}"string"==typeof n&&(e&&(n=n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),a&&(n='"'+n+'"')),l.push(n)}if("varref"==a){let e=n,a=null,i=!0,l="";for(let f=0;f<r.length&&null!=n;f++)switch(r[f].type){case"identifier":case"string":l+=r[f].data,a=null;break;case"template":l+="object"!=typeof(a=this.expand(r[f].data,e,"arg","template"))?a:"";break;case"base-string":l+=this.expand(r[f].data,e,"arg","base-string"),a=null;break;case"access":if(a&&"object"==typeof a)n=a;else{for(l||(l="this");;)if("!"==l[0])l=l.substr(1);else{if("$"!=l[0])break;l=l.substr(1)}if("this"!=l&&null!=n){let e=n;null===(n=l in n?n[l]:null)&&i&&l in t.functions&&(n=t.functions[l](null,null,e)),i=!1}}l=""}for(;""!=l;)if("!"==l[0])l=l.substr(1);else{if("$"!=l[0])break;l=l.substr(1)}return"this"!=l?[n,l]:null}if("fn"==i){var f=[];if(f.push(t.expand(r[0],n,"text","base-string")),"_"+f[0]in t.functions&&(f[0]="_"+f[0]),!(f[0]in t.functions)){if(1==t.strict)throw new Error("Expression function `"+f[0]+"` not found.");return`(Unknown: ${f[0]})`}if("_"==f[0][0])return t.functions[f[0]](r,n);for(let e=1;e<r.length;e++)f.push(t.expand(r[e],n,"arg","base-string"));l.push(t.functions[f[0]](f,r,n))}if("template"==i){if(1==r.length){if(1==r[0].length&&"string"==r[0][0].type)return r[0][0].data;if(1==r[0].length&&"identifier"==r[0][0].type){let e=r[0][0].data;if(e in t.functions||"_"+e in t.functions)return t.expand(r,n,a,"fn")}return t.expand(r[0],n,a,"var")}return t.expand(r,n,a,"fn")}if("base-string"==i){let e=-1;for(let i of r){let f=null;switch(e++,i.type){case"template":f=t.expand(i.data,n,a,"template");break;case"string":case"identifier":f=i.data;break;case"base-string":f=t.expand(i.data,n,a,"base-string")}"void"!=a&&("last"==a&&e!=r.length-1||l.push(f))}}if("obj"==a)return l;if("last"==a)return"Rose\\Arry"==typeOf(l)&&(l=l[0]),l;if("void"==a)return null;if("arg"==a)return"array"==e.typeOf(l)?1!=l.length?l.join(""):l[0]:l;if("text"==a&&"array"==e.typeOf(l)){let e=t=>null!=t&&"object"==typeof t?"map"in t?t.map(e).join(""):"join"in t?t.join(""):t.toString():t;l=l.map(e).join("")}return l},compile:function(e){return e=t.parse(e),function(r=null,n="text"){return t.expand(e,r||{},n)}},eval:function(e,r=null,n="text"){return e=t.parse(e),t.expand(e,r||{},n)},register:function(e,r){t.functions[e]=r}};t.functions={null:function(e){return null},true:function(e){return!0},false:function(e){return!1},len:function(e){return e[1].toString().length},int:function(e){return~~e[1]},str:function(e){return e[1].toString()},float:function(e){return parseFloat(e[1])},chr:function(e){return String.fromCharCode(e[1])},ord:function(e){return e[1].toString().charCodeAt(0)},not:function(e){return!e[1]},neg:function(e){return-e[1]},abs:function(e){return Math.abs(e[1])},eq:function(e){return e[1]==e[2]},ne:function(e){return e[1]!=e[2]},lt:function(e){return e[1]<e[2]},le:function(e){return e[1]<=e[2]},gt:function(e){return e[1]>e[2]},ge:function(e){return e[1]>=e[2]},and:function(e){for(let t=1;t<e.length;t++)if(!e[t])return!1;return!0},or:function(e){for(let t=1;t<e.length;t++)if(~~e[t])return!0;return!1},isnotnull:function(e){return!!e[1]},isnull:function(e){return!e[1]},"*":function(e){let t=e[1];for(let r=2;r<e.length;r++)t*=e[r];return t},mul:function(e){let t=e[1];for(let r=2;r<e.length;r++)t*=e[r];return t},"/":function(e){let t=e[1];for(let r=2;r<e.length;r++)t/=e[r];return t},div:function(e){let t=e[1];for(let r=2;r<e.length;r++)t/=e[r];return t},"+":function(e){let t=e[1];for(let r=2;r<e.length;r++)t-=-e[r];return t},sum:function(e){let t=e[1];for(let r=2;r<e.length;r++)t-=-e[r];return t},"-":function(e){let t=e[1];for(let r=2;r<e.length;r++)t-=e[r];return t},sub:function(e){let t=e[1];for(let r=2;r<e.length;r++)t-=e[r];return t},json:function(e){return JSON.stringify(e[1])},set:function(e,r,n){if(r[1].length>1){let a=t.expand(r[1],n,"varref");return null!=a&&(a[0][a[1]]=e[2]),""}return n[e[1]]=e[2],""},trim:function(e){return e[1]?"object"==typeof e[1]?e[1].map(e=>e.trim()):e[1].trim():""},upper:function(e){return e[1]?"object"==typeof e[1]?e[1].map(e=>e.toUpperCase()):e[1].toUpperCase():""},lower:function(e){return e[1]?"object"==typeof e[1]?e[1].map(e=>e.toLowerCase()):e[1].toLowerCase():""},substr:function(e){let t=e[e.length-1].toString(),r=0,n=null;return 4==e.length?(r=~~e[1],n=~~e[2]):(r=~~e[1],n=null),r<0&&(r+=t.length),n<0&&(n+=t.length),null===n&&(n=t.length-r),t.substr(r,n)},nl2br:function(e){return e[1]?"object"==typeof e[1]?e[1].map(e=>e.replace(/\n/g,"<br/>")):e[1].replace(/\n/g,"<br/>"):""},"%":function(t){t.shift();var r=t.shift();let n="";for(let a=0;a<t.length;a++)if("array"==e.typeOf(t[a])){n+=`<${r}>`;for(let e=0;e<t[a].length;e++)n+=t[a][e];n+=`</${r}>`}else n+=`<${r}>${t[a]}</${r}>`;return n},"%%":function(e){e.shift();var t=e.shift();let r="",n="";for(let a=0;a<e.length;a+=2)a+1<e.length?r+=` ${e[a]}="${e[a+1]}"`:n=e[a];return n?`<${t}${r}>${n}</${t}>`:`<${t}${r}/>`},join:function(t){return t[2]&&"array"==e.typeof(t[2])?t[2].join(t[1]):""},split:function(e){return e[2]&&"string"==typeof e[2]?e[2].split(e[1]):[]},keys:function(e){return e[1]&&"object"==typeof e[1]?Object.keys(e[1]):[]},values:function(e){return e[1]&&"object"==typeof e[1]?Object.values(e[1]):[]},_each:function(e,r){let n=t.expand(e[1],r,"arg"),a=t.expand(e[2],r,"arg"),i=[],l=0;for(let f in a){r[n]=a[f],r[n+"##"]=l++,r[n+"#"]=f;for(let n=3;n<e.length;n++)i.push(t.expand(e[n],r,"text"))}return delete r[n],delete r[n+"##"],delete r[n+"#"],i},"_?":function(e,r){return t.expand(e[1],r,"arg")?t.expand(e[2],r,"arg"):e.length>3?t.expand(e[3],r,"arg"):""},_if:function(e,r){for(let n=0;n<e.length;n+=3){if("else"==t.expand(e[n],r,"arg"))return t.expand(e[n+1],r,"text");if(t.expand(e[n+1],r,"arg"))return t.expand(e[n+2],r,"text")}return""},_switch:function(e,r){let n=t.expand(e[1],r,"arg");for(let a=2;a<e.length;a+=2){let i=t.expand(e[a],r,"arg");if(i==n||"default"==i)return t.expand(e[a+1],r,"text")}return""},repeat:function(e,r,n){let a="i",i=~~e[1],l=0,f=2;e[f]&&null!=e[f].match(/^[0-9]+$/)&&(i=(l=i)+~~e[f++]),e[f]&&"identifier"==r[f][0].type&&null!=e[f].match(/^[A-Za-z0-9_-]+$/)&&(a=e[f++]);let s=[];for(let o=l;o<i;o++){n[a]=o;for(let e=f;e<r.length;e++)s.push(t.expand(r[e],n,"text"))}return delete n[a],s},_load:function(e,r){let n=t.expand(e[1],r,"arg");if("object"!=typeof n)return"";for(let t in n)r[t]=n[t];return""},_echo:function(e,r){let n="";for(let a=1;a<e.length;a++)n+=t.expand(e[a],r,"arg");return console.log(n),""},"_#":function(e,r){let n=[];for(let a=1;a<e.length;a++)n.push(t.expand(e[a],r,"arg"));return n},"_##":function(e,t){let r=[];for(let n=1;n<e.length;n++)r.push(e[n]);return r},"_&":function(e,r){let n={};for(let a=1;a<e.length;a+=2){let i=t.expand(e[a],r,"arg");":"==i.substr(-1)&&(i=i.substr(0,i.length-1)),n[i]=t.expand(e[a+1],r,"arg")}return n},"_&&":function(e,r){let n={};for(let a=1;a<e.length;a+=2){let i=t.expand(e[a],r,"arg");":"==i.substr(-1)&&(i=i.substr(0,i.length-1)),n[i]=e[a+1]}return n},has:function(e,t,r){let n=e[1];if("object"!=typeof n)return r.err="Argument is not a Map",!1;let a="";for(let i=2;i<e.length;i++)e[i]in n||(a+=", "+e[i]);return""==a||(r.err=a.substr(1),!1)},_map:function(e,r){let n=t.expand(e[1],r,"arg"),a=t.expand(e[2],r,"arg"),i=0;for(let l in a)r[n]=a[l],r[n+"##"]=i++,r[n+"#"]=l,a[l]=t.expand(e[3],r,"arg");return delete r[n],delete r[n+"##"],delete r[n+"#"],[]},expand:function(e,r,n){return t.expand(t.parseTemplate(e[1],"{","}"),3==e.length?e[2]:n)}};
},{"./alpha":"DqrR"}],"MJTl":[function(require,module,exports) {
let e=require("./alpha");e.Rin=e,e.Class=require("./class"),e.Event=require("./event"),e.EventDispatcher=require("./event-dispatcher"),e.Model=require("./model"),e.ModelList=require("./model-list"),e.Schema=require("./schema"),e.Flattenable=require("./flattenable"),e.Collection=require("./collection"),e.Template=require("./template"),Object.assign(module.exports,e);
},{"./alpha":"DqrR","./class":"voWE","./event":"C33R","./event-dispatcher":"xxCV","./model":"UP3c","./model-list":"OJpq","./schema":"z45J","./flattenable":"gwLi","./collection":"ZP4A","./template":"iJ0q"}],"hPM2":[function(require,module,exports) {
const{EventDispatcher:t}=require("@rsthn/rin");let e=module.exports={Route:t.extend({routeRegex:null,value:null,params:null,s_args:null,active:!1,changed:!1,__ctor:function(t){this._super.EventDispatcher.__ctor(),this._compileRoute(this.value=t)},_compileRoute:function(t){for(this.params=[];;){var e=/:([!@A-Za-z0-9_-]+)/.exec(t);if(!e)break;t=t.replace(e[0],"([^/]+)"),this.params.push(e[1])}this.routeRegex="^"+t.replace(/##/g,"")},addHandler:function(t,e){this.addEventListener((!0===e?"un":"")+"routed",t,null)},removeHandler:function(t,e){this.removeEventListener((!0===e?"un":"")+"routed",t,null)},dispatch:function(t){var e=t.match(this.routeRegex);if(!e)return this.s_args=null,this.active&&this.dispatchEvent("unrouted",{route:this}),this.active=!1;for(var s={route:this},r="",o=0;o<this.params.length;o++)s[this.params[o]]=e[o+1],r+="_"+e[o+1];return this.changed=r!=this.s_args,this.dispatchEvent("routed",s),this.s_args=r,this.active=!0}}),routes:{},sortedRoutes:[],ignoreHashchangeEvent:0,location:"",args:[],init:function(){this.alreadyAttached||(this.alreadyAttached=!0,"onhashchange"in globalThis&&(globalThis.onhashchange=this.onLocationChanged.bind(this)))},refresh:function(){this.onLocationChanged()},setRoute:function(t,s){var r=e.realLocation(t);r!=this.location&&(s&&this.ignoreHashchangeEvent++,globalThis.location.hash=r)},addRoute:function(t,s,r){this.routes[t]||(this.routes[t]=new e.Route(t),this.sortedRoutes.push(t),this.sortedRoutes.sort(function(t,s){return e.routes[t].routeRegex.length-e.routes[s].routeRegex.length})),void 0!==r?(this.routes[t].addHandler(s,!1),this.routes[t].addHandler(r,!0)):this.routes[t].addHandler(s,!1)},addRoutes:function(t){for(var s in t)this.routes[s]||(this.routes[s]=new e.Route(s),this.sortedRoutes.push(s)),this.routes[s].addHandler(t[s],!1);this.sortedRoutes.sort(function(t,s){return e.routes[t].routeRegex.length-e.routes[s].routeRegex.length})},removeRoute:function(t,e,s){this.routes[t]&&(void 0!==s?(this.routes[t].removeHandler(e,!1),this.routes[t].removeHandler(s,!0)):this.routes[t].removeHandler(e))},removeRoutes:function(t){for(var e in t)this.routes[e]&&this.routes[e].removeHandler(t[e])},realLocation:function(t,e){e||(e=this.location),e||(e=" ");for(var s,r=0,o=0,i=0,n="";-1!=r&&o<t.length&&i<e.length;)switch(r){case 0:if("*"==t.substr(o++,1)){r=1;break}if(t.substr(o-1,1)!=e.substr(i++,1)){n+=t.substr(o-1),r=-1;break}n+=e.substr(i-1,1);break;case 1:if("*"==t.substr(o,1)){r=3,o++;break}r=2;break;case 2:if(-1==(s=e.indexOf(t.substr(o,1),i))){n+=e.substr(i)+t.substr(o),r=-1;break}n+=e.substr(i,s-i),r=0,i=s;break;case 3:if(-1==(s=e.lastIndexOf(t.substr(o,1)))){n+=t.substr(o),r=-1;break}n+=e.substr(i,s-i),r=0,i=s}return-1!=r&&(n+=t.substr(o)),n.trim()},onLocationChanged:function(){var t=location.hash.substr(1),s=e.realLocation(t);if(t==s)if(this.location=t,this.args=this.location.split("/"),this.ignoreHashchangeEvent>0)this.ignoreHashchangeEvent--;else for(var r=0;r<this.sortedRoutes.length;r++)this.routes[this.sortedRoutes[r]].dispatch(this.location);else globalThis.location.replace("#"+s)}};e.init();
},{"@rsthn/rin":"MJTl"}],"yFRv":[function(require,module,exports) {
const{Rin:t,Model:e,Template:i}=require("@rsthn/rin"),s=module.exports={protos:{},isRoot:!0,refs:null,modelt:e,model:null,events:null,__ctor:function(){if(this._list_watch=[],this._list_visible=[],this._list_property=[],this.refs={},null!=this.model){let t=this.model;this.model=null,this.setModel(t)}this.isReady=!1,this.init(),Object.keys(this._super).reverse().forEach(t=>{"init"in this._super[t]&&this._super[t].init()}),this.events&&this.bindEvents(this.events);const t=()=>{this.ready(),this.isReady=!0,Object.keys(this._super).reverse().forEach(t=>{"ready"in this._super[t]&&this._super[t].ready()}),this.collectWatchers(),this.root&&this.root._mutationHandler&&this.root._mutationHandler()};let e=null;this._mutationHandler=(()=>{if(0!=this.children.length){this.querySelectorAll("[data-pending=true]").forEach(t=>{this.findRoot(t.parentElement)===this&&t.connectReference(this)});for(let t in this.refs)if(!this.refs[t].isReady)return;e&&clearTimeout(e),e=setTimeout(()=>{e=null;for(let t in this.refs)if(!this.refs[t].isReady)return;for(let t of this.querySelectorAll("[data-ref]"))"true"!=t.dataset.linked&&(this[t.dataset.ref]=t,this.refs[t.dataset.ref]=t,t.dataset.linked="true",t.root=this,this.onRefAdded(t.dataset.ref));this._mutationHandler=null,this._mutationObserver.disconnect(),this._mutationObserver=null,t()},50)}}),this._mutationObserver=new MutationObserver(this._mutationHandler),this._mutationObserver.observe(this,{attributes:!1,childList:!0,subtree:!1}),this._mutationHandler()},init:function(){},ready:function(){},getRoot:function(){return this.root?this.root:this.root=this.findRoot()},setModel:function(e,i){return e?(e=t.ensureTypeOf(this.modelt,e),null!=this.model&&(this.model.removeEventListener("modelChanged",this.onModelPreChanged,this),this.model.removeEventListener("propertyChanging",this.onModelPropertyChanging,this),this.model.removeEventListener("propertyChanged",this.onModelPropertyPreChanged,this),this.model.removeEventListener("propertyRemoved",this.onModelPropertyRemoved,this)),this.model=e,this.model.addEventListener("modelChanged",this.onModelPreChanged,this),this.model.addEventListener("propertyChanging",this.onModelPropertyChanging,this),this.model.addEventListener("propertyChanged",this.onModelPropertyPreChanged,this),this.model.addEventListener("propertyRemoved",this.onModelPropertyRemoved,this),!1!==i&&this.model.update(),this):this},getModel:function(){return this.model},getWidth:function(t){return(t||this).getBoundingClientRect().width},getHeight:function(t){return(t||this).getBoundingClientRect().height},bindEvents:function(e){for(var i in e){let l=e[i];"string"==t.typeOf(l)&&(l=this[l]),l=l.bind(this);var s=i.indexOf(" "),n=-1==s?i:i.substr(0,s),r=-1==s?"":i.substr(s+1);let h=null;var o=n.indexOf("(");if(-1!=o&&(h=n.substr(o+1,n.length-o-2).split(","),n=n.substr(0,o)),"@"!=r.substr(0,1))if("#"!=n.substr(0,1)){if(null!=h)switch(n){case"keyup":case"keydown":this.listen(n,r,function(e){if(-1!=t.indexOf(h,e.keyCode.toString()))return l(e,h);e.continuePropagation=!0});continue}this.listen(n,r,l)}else this.listen("propertyChanged."+n.substr(1),l);else"this"==r.substr(1)?this.listen(n,l):this[r.substr(1)].addEventListener(n,l)}return this},listen:function(e,i,s){"function"==t.typeOf(i)&&(s=i,i=null);let n=null,r=this;return this.addEventListener(e,n=(e=>{if(this.findRoot(e.target)===this&&!1!==e.continuePropagation){if(e.continuePropagation=!0,i&&"*"!=i){let n=this.querySelectorAll(i);for(e.source=e.target;e.source!==this;){if(-1!==t.indexOf(n,e.source)){e.continuePropagation=!1,s.call(this,e,e.detail);break}e.source=e.source.parentElement}}else e.continuePropagation=!1,s.call(this,e,e.detail);e.continuePropagation||(e.preventDefault(),e.stopPropagation())}}),!0),{removed:!1,remove:function(){this.removed||(this.removed=!0,r.removeEventListener(e,n,!0))}}},dispatch:function(t,e){this.dispatchEvent(new CustomEvent(t,{bubbles:!0,detail:e}))},setInnerHTML:function(t){null==this._mutationObserver?(this.innerHTML=t,this.collectWatchers()):this.innerHTML=t},collectWatchers:function(){let t,e=this,s=!1,n=this._list_watch.length,r=this._list_visible.length,o=this._list_property.length;t=this.querySelectorAll("[data-watch]");for(let l=0;l<t.length;l++){for(let e of t[l].querySelectorAll(".pseudo"))e.remove();t[l]._template=i.compile(t[l].innerHTML),t[l]._watch=new RegExp(t[l].dataset.watch),t[l].innerHTML="",t[l].removeAttribute("data-watch"),this._list_watch.push(t[l])}t=this.querySelectorAll("[data-visible]");for(let l=0;l<t.length;l++)t[l]._visible=i.compile(t[l].dataset.visible),t[l].removeAttribute("data-visible"),this._list_visible.push(t[l]);t=this.querySelectorAll("[data-property]");for(let i=0;i<t.length;i++)t[i].onchange=t[i].onblur=function(){switch(this.type){case"checkbox":e.getModel().set(this.name,this.checked?"1":"0");break;case"field":e.getModel().set(this.name,this.getValue());break;default:e.getModel().set(this.name,this.value)}},"SELECT"==t[i].tagName&&(t[i].onmouseup=function(){e.getModel().set(this.name,this.value)}),t[i].name=t[i].dataset.property,t[i].removeAttribute("data-property"),this._list_property.push(t[i]);this._list_watch=this._list_watch.filter(t=>null!=t.parentElement),n!=this._list_watch.length&&(s=!0),this._list_visible=this._list_visible.filter(t=>null!=t.parentElement),r!=this._list_visible.length&&(s=!0),this._list_property=this._list_property.filter(t=>null!=t.parentElement),o!=this._list_property.length&&(s=!0),null!=this.model&&s&&this.model.update()},onCreated:function(){},onConnected:function(){},onDisconnected:function(){},onRefAdded:function(t){},onRefRemoved:function(t){},onModelPreChanged:function(t,e){let i=this.getModel().get();for(let s=0;s<this._list_watch.length;s++)for(let t of e.fields)if(this._list_watch[s]._watch.test(t)){this._list_watch[s].innerHTML=this._list_watch[s]._template(i);break}for(let s=0;s<this._list_visible.length;s++)this._list_visible[s]._visible(i,"arg")?this._list_visible[s].style.display="block":this._list_visible[s].style.display="none";this.onModelChanged(t,e)},onModelChanged:function(t,e){},onModelPropertyChanging:function(t,e){},onModelPropertyPreChanged:function(t,e){for(let i=0;i<this._list_property.length;i++)if(this._list_property[i].name==e.name){let t=!0;switch(this._list_property[i].type){case"radio":if(this._list_property[i].value!=e.value){this._list_property[i].parentElement.classList.remove("active");continue}this._list_property[i].checked=!0,this._list_property[i].parentElement.classList.add("active");break;case"checkbox":~~e.value?(this._list_property[i].checked=!0,this._list_property[i].parentElement.classList.add("active")):(this._list_property[i].checked=!1,this._list_property[i].parentElement.classList.remove("active"));break;case"field":this._list_property[i].setValue(e.value),t=!1;break;default:this._list_property[i].value=e.value,this._list_property[i].value!=e.value&&(t=!1)}t&&this._list_property[i].onchange&&this._list_property[i].onchange()}this.onModelPropertyChanged(t,e)},onModelPropertyChanged:function(t,e){this.dispatch("propertyChanged."+e.name,e),this.dispatch("propertyChanged",e)},onModelPropertyRemoved:function(t,e){},register:function(e,...i){var n=class extends HTMLElement{constructor(){super(),this.invokeConstructor=!0,this._super={};for(let t of Object.entries(this.constructor.prototype._super)){this._super[t[0]]={};for(let e of Object.entries(t[1]))this._super[t[0]][e[0]]=e[1].bind(this)}this.onCreated()}findRoot(t){let e=t||this.parentElement;for(;null!=e;){if("isRoot"in e&&e.isRoot)return e;e=e.parentElement}return null}connectReference(t=null,e=255){this.dataset.ref&&(this.root||1!=(1&e)||(null==t&&(t=this.findRoot()),null!=t?(t[this.dataset.ref]=this,t.refs[this.dataset.ref]=this,delete this.dataset.pending,this.dataset.linked="true",this.root=t):this.dataset.pending=!0),this.root&&2==(2&e)&&this.root.onRefAdded(this.dataset.ref))}connectedCallback(){this.connectReference(null,1),this.invokeConstructor&&(this.invokeConstructor=!1,this.__ctor()),this.connectReference(null,2),this.onConnected()}disconnectedCallback(){this.dataset.ref&&this.root&&(this.root.onRefRemoved(this.dataset.ref),delete this.dataset.pending,root[this.dataset.ref]=null,root.refs[this.dataset.ref]=null,this.dataset.linked="false",this.root=null),this.onDisconnected()}};t.override(n.prototype,s);const r={},o={},l={};for(let h=0;h<i.length;h++)if(i[h]){if("string"==t.typeOf(i[h])){const e=i[h];if(i[h]=s.protos[e],!i[h])continue;o[e]={};for(let s in i[h])"function"==t.typeOf(i[h][s])&&(o[e][s]=i[h][s])}"_super"in i[h]&&t.override(o,i[h]._super),"events"in i[h]&&t.override(l,i[h].events),t.override(n.prototype,i[h]),t.override(r,i[h])}return n.prototype._super=o,n.prototype.events=l,r._super=o,customElements.define(e,n),s.protos[e]=r,n}};
},{"@rsthn/rin":"MJTl"}],"SJdT":[function(require,module,exports) {
var global = arguments[3];
var define;
var e,t=arguments[3];!function(r){var o="object"==typeof exports&&exports,a="object"==typeof module&&module&&module.exports==o&&module,n="object"==typeof t&&t;n.global!==n&&n.window!==n||(r=n);var c=function(e){this.message=e};(c.prototype=new Error).name="InvalidCharacterError";var h=function(e){throw new c(e)},d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=/[\t\n\f\r ]/g,s={encode:function(e){e=String(e),/[^\0-\xFF]/.test(e)&&h("The string to be encoded contains characters outside of the Latin1 range.");for(var t,r,o,a,n=e.length%3,c="",i=-1,s=e.length-n;++i<s;)t=e.charCodeAt(i)<<16,r=e.charCodeAt(++i)<<8,o=e.charCodeAt(++i),c+=d.charAt((a=t+r+o)>>18&63)+d.charAt(a>>12&63)+d.charAt(a>>6&63)+d.charAt(63&a);return 2==n?(t=e.charCodeAt(i)<<8,r=e.charCodeAt(++i),c+=d.charAt((a=t+r)>>10)+d.charAt(a>>4&63)+d.charAt(a<<2&63)+"="):1==n&&(a=e.charCodeAt(i),c+=d.charAt(a>>2)+d.charAt(a<<4&63)+"=="),c},decode:function(e){var t=(e=String(e).replace(i,"")).length;t%4==0&&(t=(e=e.replace(/==?$/,"")).length),(t%4==1||/[^+a-zA-Z0-9/]/.test(e))&&h("Invalid character: the string to be decoded is not correctly encoded.");for(var r,o,a=0,n="",c=-1;++c<t;)o=d.indexOf(e.charAt(c)),r=a%4?64*r+o:o,a++%4&&(n+=String.fromCharCode(255&r>>(-2*a&6)));return n},version:"0.1.0"};if("function"==typeof e&&"object"==typeof e.amd&&e.amd)e(function(){return s});else if(o&&!o.nodeType)if(a)a.exports=s;else for(var f in s)s.hasOwnProperty(f)&&(o[f]=s[f]);else r.base64=s}(this);
},{}],"z2hx":[function(require,module,exports) {

"use strict";var e=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t)return t;throw new Error("unable to locate global object")},t=e();module.exports=exports=t.fetch,exports.default=t.fetch.bind(t),exports.Headers=t.Headers,exports.Request=t.Request,exports.Response=t.Response;
},{}],"LVu9":[function(require,module,exports) {
const e=require("base-64");"fetch"in globalThis||(globalThis.fetch=require("node-fetch")),module.exports={apiUrl:"/api",useReq64:!1,retries:1,_requestLevel:0,_requestPackage:0,_packageData:[],responseFilter:function(e,t){return!0},packageBegin:function(){this._requestPackage++},packageEnd:function(){this._requestPackage&&(--this._requestPackage||this.packageSend())},packageSend:function(){if(!this._packageData.length)return;let t=this._packageData;this._packageData=[];for(var s="",i=0;i<t.length;i++)s+="r"+i+","+e.encode(this.encodeParams(t[i][2]))+";";this._showProgress(),this.post({rpkg:s},(e,s)=>{for(let a=0;a<t.length;a++)try{var i=e["r"+a];if(!i){null!=t[a][1]&&t[a][1](t[a][2]);continue}null!=t[a][0]&&this.responseFilter(i,t[a][2])&&t[a][0](i,t[a][2])}catch(n){}},e=>{for(let s=0;s<t.length;s++)null!=t[s][1]&&t[s][1](t[s][2])})},_showProgress:function(){"document"in globalThis&&(this._requestLevel++,this._requestLevel>0&&globalThis.document.documentElement.classList.add("busy"))},_hideProgress:function(){"document"in globalThis&&(this._requestLevel--,this._requestLevel||globalThis.document.documentElement.classList.remove("busy"))},encodeParams:function(e){let t=[];for(let s in e)t.push(encodeURIComponent(s)+"="+encodeURIComponent(e[s]));return t.join("&")},apiCall:function(t,s,i,n,a){let o=this.apiUrl;if("GET"!=n&&"POST"!=n&&(n="auto"),this._requestPackage)return void this._packageData.push([s,i,t]);this._showProgress();let r=t;t=this.encodeParams(t),"auto"!=n||this.useReq64||(n=t.length<960?"GET":n),void 0===a&&(a=this.retries),"auto"==n&&(n="POST"),this.useReq64&&(t="_req64="+e.encode(t)),("GET"==n?globalThis.fetch(o+"?_="+Date.now()+"&"+t):globalThis.fetch(o,{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",body:t})).then(e=>e.json()).then(e=>{this._hideProgress(),s&&this.responseFilter(e,r)&&s(e,r)}).catch(e=>{this._hideProgress(),0==a?i&&i(r):this.apiCall(r,s,i,n,a-1)})},post:function(e,t,s){return this.apiCall(e,t,s,"POST")},get:function(e,t,s){return this.apiCall(e,t,s,"GET")},fetch:function(e){return new Promise((t,s)=>{this.apiCall(e,t,s)})}};
},{"base-64":"SJdT","node-fetch":"z2hx"}],"eKHE":[function(require,module,exports) {
let t=require("../element"),e=require("../router");t.register("r-tabs",{events:{"click [data-name]":function(t){t.continuePropagation=!0,this.dataset.baseRoute?window.location="#"+this.dataset.baseRoute.replace("@",t.source.dataset.name):this.selectTab(t.source.dataset.name)}},init:function(){this._routeHandler=((t,e)=>{e.route.changed&&this._showTab(e.tabName)})},ready:function(){"container"in this.dataset?this.container=document.querySelector(this.dataset.container):this.container=this.nextElementSibling,this._hideTabsExcept(null)},onConnected:function(){this.dataset.baseRoute&&e.addRoute(this.dataset.baseRoute.replace("@",":tabName"),this._routeHandler)},onDisconnected:function(){this.dataset.baseRoute&&e.removeRoute(this.dataset.baseRoute.replace("@",":tabName"),this._routeHandler)},_hideTabsExcept:function(t){if(null==this.container)return;t||(t="");for(let a=0;a<this.container.children.length;a++)this.container.children[a].dataset.name==t?(this.container.children[a].classList.contains("hidden")&&this.dispatch("tab-activate",{name:this.container.children[a].dataset.name,el:this.container.children[a]}),this.container.children[a].classList.remove("hidden")):(this.container.children[a].classList.contains("hidden")||this.dispatch("tab-deactivate",{name:this.container.children[a].dataset.name,el:this.container.children[a]}),this.container.children[a].classList.add("hidden"));let e=this.querySelectorAll("[data-name]");if(e)for(let a=0;a<e.length;a++)e[a].dataset.name==t?e[a].classList.add("active"):e[a].classList.remove("active")},_showTab:function(t){return this._hideTabsExcept(t)},selectTab:function(t){if(this.dataset.baseRoute){const e="#"+this.dataset.baseRoute.replace("@",t);if(window.location.hash!=e)return void(window.location=e)}this._showTab(t)}});
},{"../element":"yFRv","../router":"hPM2"}],"uIMb":[function(require,module,exports) {
module.exports={Tabs:require("./elems/r-tabs")};
},{"./elems/r-tabs":"eKHE"}],"epB2":[function(require,module,exports) {
module.exports={Router:require("./router"),Element:require("./element"),Api:require("./api"),Elements:require("./elements")};
},{"./router":"hPM2","./element":"yFRv","./api":"LVu9","./elements":"uIMb"}]},{},["epB2"], "front")
//# sourceMappingURL=/rin-front.js.map