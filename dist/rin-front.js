parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"DqrR":[function(require,module,exports) {
let e=module.exports={};e.invokeLater=function(e){e&&setTimeout(function(){e()},10)},e.wait=function(e){return new Promise(function(n,t){setTimeout(n,e)})},e.typeOf=function(e){return e instanceof Array?"array":null===e?"null":(typeof e).toString().toLowerCase()},e.isArrayOrObject=function(n){switch(e.typeOf(n)){case"array":case"object":return!0}return!1},e.clone=function(n){var t;if("array"==e.typeOf(n)){t=[];for(let r=0;r<n.length;r++)t.push(e.clone(n[r]))}else if("object"==e.typeOf(n)){t={};for(let r in n)t[r]=e.clone(n[r])}else t=n;return t},e.merge=function(n,...t){if("array"==e.typeOf(n))for(let r=0;r<t.length;r++){let o=t[r];if("array"!=e.typeOf(o))n.push(o);else for(let t=0;t<o.length;t++)n.push(e.clone(o[t]))}else if("object"==e.typeOf(n))for(let r=0;r<t.length;r++){let o=t[r];if("object"==e.typeOf(o))for(let t in o)e.isArrayOrObject(o[t])?t in n?e.merge(n[t],o[t]):n[t]=e.clone(o[t]):n[t]=o[t]}return n},e.override=function(e,...n){for(let t=0;t<n.length;t++)for(let r in n[t])e[r]=n[t][r];return e},e.partialCompare=function(e,n){if(null==e||null==n)return!1;if(e===n)return!0;for(var t in n)if(e[t]!=n[t])return!1;return!0},e.arrayFind=function(e,n,t){for(var r=0;e&&r<e.length;r++)if(this.partialCompare(e[r],n))return t?e[r]:r;return!!t&&null},e.indexOf=function(e,n,t=!1){if(t){for(let t=0;t<e.length;t++)if(e[t]===n)return t;return-1}for(let r in e)if(e[r]===n)return r;return-1},e.escape=function(e){return(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},e.ensureTypeOf=function(e,n){return!n||!e||n instanceof e?n:n.isInstanceOf&&e.prototype.className&&n.isInstanceOf(e.prototype.className)?n:new e(n)},e.isTypeOf=function(e,n){return!n||!e||n instanceof e||!!(n.isInstanceOf&&e.prototype.className&&n.isInstanceOf(e.prototype.className))},e.serialize=function(e){return JSON.stringify(e)},e.deserialize=function(e){return JSON.parse(e)},e.hookAppend=function(e,n,t,r=!0){const o=e[n].bind(e);return e[n]=r?(...e)=>{if(!1!==o(...e))return t(...e)}:(...e)=>(o(...e),t(...e)),{unhook:function(){e[n]=o}}},e.hookPrepend=function(e,n,t,r=!0){const o=e[n].bind(e);return e[n]=r?(...e)=>{if(!1!==t(...e))return o(...e)}:(...e)=>(t(...e),o(...e)),{unhook:function(){e[n]=o}}};
},{}],"voWE":[function(require,module,exports) {
let t=require("./alpha"),e=module.exports=function(){};e._class=e,e._super={},e.prototype.className="Class",e.prototype.__ctor=function(){},e.prototype.__dtor=function(){},e.prototype.isInstanceOf=function(e){return(e="string"==t.typeOf(e)?e:e.prototype?e.prototype.className:e.constructor.prototype.className)in this._super||this.className==e},e.prototype._initSuperRefs=function(){var e=this.constructor._super,s={};for(let r in e){let o={},p=e[r].prototype;for(let e in p)"function"==t.typeOf(p[e])&&(o[e]=p[e].bind(this));s[r]=o}this._super=s},e.inherit=function(e){var s=this._class,r=s._super,o=s._class;if("function"==t.typeOf(e)){for(let t in e._class)/^[A-Z]/.test(t)||(s[t]=e._class[t]);t.override(s.prototype,e._class.prototype),t.override(r,e._class._super),e._class.prototype.className&&(r[e._class.prototype.className]=e._class)}else t.override(s.prototype,e);return s._super=r,s._class=o,s},e.prototype._extend=function(t,s){var r=function(...t){this._initSuperRefs(),this.__ctor.apply(this,t)};r._class=r,r._super={},e.inherit.call(r,t),delete r.prototype.className;for(let e=0;e<s.length;e++)r.inherit(s[e]);return delete r._super.Class,"classInit"in r.prototype&&r.prototype.classInit(),r},e.extend=function(...t){return this._class.prototype._extend(this,t)},e.create=function(t){return new(this.extend(t))};
},{"./alpha":"DqrR"}],"C33R":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3];let i=require("./alpha"),s=require("./class");module.exports=s.extend({className:"Event",source:null,name:null,args:null,_async:!1,list:null,next:null,ret:null,original:null,i:-1,__ctor:function(t,i,s,h,e,n){this.source=t,this.name=s,this.args=h,this.cbHandler=e,this.cbContext=n,this.list=i,this.reset()},reset:function(){return this.next=null,this.ret=[],this._async=!1,this.i=-1,this},setSource:function(t){return this.source=t,this},wait:function(){return this._async=!0,this},resume:function(){for(this._async=!1;!(this._async||++this.i>=this.list.length);)if(!this.list[this.i].silent)if("string"==i.typeOf(this.list[this.i].handler)){if(this.list[this.i].context){if(!this.list[this.i].context[this.list[this.i].handler])continue;if(!1===this.list[this.i].context[this.list[this.i].handler](this,this.args,this.list[this.i].data))break}else if(!1===t[this.list[this.i].handler].call(null,this,this.args,this.list[this.i].data))break}else if(!1===this.list[this.i].handler.call(this.list[this.i].context,this,this.args,this.list[this.i].data))break;return this._async?this:(this.i>=this.list.length&&this.next&&this.next.resume(),this.cbHandler&&this.cbHandler.call(this.cbContext),this)},from:function(t){return this.original=t,this},enqueue:function(t){if(!t)return this;var i;for(i=this;null!=i.next;i=i.next);return i.next=t,t.from(this),this}});
},{"./alpha":"DqrR","./class":"voWE"}],"xxCV":[function(require,module,exports) {
let e=require("./class"),t=require("./event");module.exports=e.extend({className:"EventDispatcher",listeners:null,namespace:null,__ctor:function(){this.listeners={}},setNamespace:function(e){return this.namespace=e,this},addEventListener:function(e,t,s,n){var i=(e=e.split(":"))[e.length-1],r=e.length>1?e[0]:null;return this.listeners[i]||(this.listeners[i]=[]),this.listeners[i].push({ns:r,handler:t,context:s,data:n,silent:0}),this},removeEventListener:function(e,t,s){var n=(e=e.split(":"))[e.length-1],i=e.length>1?e[0]:null;if("*"==n)for(var r in this.listeners)for(var l=this.listeners[r],h=0;h<l.length;h++){var a=!0;t&&(a=a&&l[h].handler===t),s&&(a=a&&l[h].context===s),i&&(a=a&&l[h].ns==i),a&&l.splice(h--,1)}else{if(!this.listeners[n])return this;for(l=this.listeners[n],h=0;h<l.length;h++){a=!0;t&&(a=a&&l[h].handler===t),s&&(a=a&&l[h].context===s),i&&(a=a&&l[h].ns==i),a&&l.splice(h--,1)}}return this},prepareEvent:function(e,s,n,i){var r=[],l=(e=e.split(":"))[e.length-1],h=e.length>1?e[0]:null;this.listeners[l]&&(r=r.concat(this.listeners[l])),this.listeners["*"]&&(r=r.concat(this.listeners["*"]));for(var a=0;a<r.length;a++)r[a].silent&&r.splice(a--,1);if(h)for(a=0;a<r.length;a++)r[a].ns!=h&&r.splice(a--,1);return new t(this,r,l,s,n,i)},silence:function(e,t){var s=(e=e.split(":"))[e.length-1],n=e.length>1?e[0]:null;if(t=!1===t?-1:1,"*"==s)for(var i in this.listeners)for(var r=this.listeners[i],l=0;l<r.length;l++)n&&r[l].ns!=n||(r[l].silent+=t);else{if(!this.listeners[s])return this;for(r=this.listeners[s],l=0;l<r.length;l++)n&&r[l].ns!=n||(r[l].silent+=t)}return this},dispatchEvent:function(e,t,s,n){return this.prepareEvent(this.namespace?this.namespace+":"+e:e,t,s,n).resume()}});
},{"./class":"voWE","./event":"C33R"}],"u2gq":[function(require,module,exports) {
module.exports={email:/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)+$/i,url:/^[\w-]+:\/\/[\w-]+(\.\w+)+.*$/,urlNoProt:/^[\w-]+(\.\w+)+.*$/,name:/^[-A-Za-z0-9_.]+$/,uname:/^['\pL\pN ]+$/,text:/^[^&<>{}]*$/,utext:/^([\r\n\pL\pN\pS &!@#$%*\[\]()_+=;',.\/?:"~-]+)$/};
},{}],"eGc5":[function(require,module,exports) {
let Rin=require("./alpha"),Regex=require("./model-regex");module.exports={_getref:function(value,obj){return"string"==typeof value?("#"==value.substr(0,1)?value=obj.get(value.substr(1)):"@"==value.substr(0,1)&&(value=obj[value.substr(1)]),"string"==typeof value?eval(value):value):value},type:function(r,e,t,n){switch(e){case"int":if(n=parseInt(n),isNaN(n))throw new Error(e);break;case"float":if(n=parseFloat(n),isNaN(n))throw new Error(e);break;case"string":n=null==n?"":n.toString();break;case"bit":if(!0===n||!1===n){n=n?1:0;break}if(n=parseInt(n),isNaN(n))throw new Error(e);n=n?1:0;break;case"array":if("array"==Rin.typeOf(n))break;if(null==n){n=[];break}throw new Error(e);case"bool":if("true"===n||!0===n){n=!0;break}if("false"===n||!1===n){n=!1;break}throw new Error(e)}return n},model:function(r,e,t,n){var o=this._getref(e,r);if(!o)throw new Error(e);return n?o.ensure(n):new o},cls:function(r,e,t,n){var o=this._getref(e,r);return n?Rin.ensureTypeOf(o,n):new o},arrayof:function(r,e,t,n){var o=this._getref(e,r);if(n||(n=[]),!o||"array"!=Rin.typeOf(n))throw new Error(e);for(var i=0;i<n.length;i++)n[i]=Rin.ensureTypeOf(o,n[i]);return n},arraynull:function(r,e,t,n){var o=!1;if("object"==Rin.typeOf(e)&&(e.remove&&(o=e.remove),e=e.value),e)return n;if("array"!=Rin.typeOf(n))throw new Error(e);for(var i=0;i<n.length;i++)if(null==n[i]){if(!o)throw new Error(e);n.splice(i--,1)}return n},arraycompliant:function(r,e,t,n){var o=!1;if("object"==Rin.typeOf(e)&&(e.remove&&(o=e.remove),e=e.value),!e)return n;if("array"!=Rin.typeOf(n))throw new Error(e);for(var i=0;i<n.length;i++)if(null!=n[i]&&!n[i].isCompliant()){if(!o)throw new Error(e);n.splice(i--,1)}return n},required:function(r,e,t,n){if(null==n)throw new Error(e?"":"null");switch(Rin.typeOf(n)){case"array":if(0==n.length)throw new Error(e?"":"null");break;default:if(0==n.toString().length)throw new Error(e?"":"null")}return n},minlen:function(r,e,t,n){if(n.toString().length<e)throw new Error(e);return n},maxlen:function(r,e,t,n){if(n.toString().length>e)throw new Error(e);return n},minval:function(r,e,t,n){if(parseFloat(n)<e)throw new Error(e);return n},maxval:function(r,e,t,n){if(parseFloat(n)>e)throw new Error(e);return n},mincount:function(r,e,t,n){if("array"!=Rin.typeOf(n)||n.length<e)throw new Error(e);return n},maxcount:function(r,e,t,n){if("array"!=Rin.typeOf(n)||n.length>e)throw new Error(e);return n},pattern:function(r,e,t,n){if(!Regex[e].test(n.toString()))throw new Error(e);return n},inset:function(r,e,t,n){if("array"!=Rin.typeOf(e)){if(!new RegExp("^("+e.toString()+")$").test(n.toString()))throw new Error(e);return n}if(-1==e.indexOf(n.toString()))throw new Error(e.join("|"));return n},upper:function(r,e,t,n){return e?n.toString().toUpperCase():n},lower:function(r,e,t,n){return e?n.toString().toLowerCase():n}};
},{"./alpha":"DqrR","./model-regex":"u2gq"}],"UP3c":[function(require,module,exports) {
let t=require("./alpha"),i=require("./event-dispatcher"),s=module.exports=i.extend({className:"Model",defaults:null,constraints:null,data:null,changedList:null,_silent:0,_level:0,__ctor:function(t,i){if(this._super.EventDispatcher.__ctor(),this.data={},null!=i)this.reset(i);else{var s=null;if(!this.defaults&&this.constraints){s={};for(var e in this.constraints){var n=this.constraints[e];null!==n.def&&void 0!==n.def?"function"==typeof n.def?s[e]=n.def():s[e]=n.def:s[e]=null}}this.reset(s)}this.init(),null!=t&&this.set(arguments[0],!0),this.constraints&&this.update(),this.ready()},reset:function(i,s){if(!this.defaults){if(!i||"object"!=t.typeOf(i)&&"function"!=t.typeOf(i))return this;this.defaults=i}return"function"==t.typeOf(this.defaults)?this.data=this.defaults():this.data=t.clone(this.defaults),!1===s||!1===i?this:this.update(null,!0)},init:function(){},ready:function(){},silent:function(t){return this._silent+=t?1:-1,this},_validate:function(t,i){if(!this.constraints||!this.constraints[t])return i;var e=this.constraints[t],n=i;for(var a in e)if(s.Constraints[a])try{n=s.Constraints[a](this,e[a],t,n)}catch(r){if("null"==r.message)break;throw new Error(`Constraint [${a}:${e[a]}] failed on property '${t}'.`)}return n},_set:function(t,i){if(!this.constraints||!this.constraints[t])return this.data[t]=i,i;var e=this.constraints[t],n=(this.data[t],i);for(var a in e)if(s.Constraints[a])try{n=s.Constraints[a](this,e[a],t,n)}catch(r){if("null"==r.message)break;this._silent||this.dispatchEvent("constraintError",{constraint:a,message:r.message,name:t,value:i});break}return this.data[t]=n},_propertyEvent:function(t,i,s,e){var n={name:t,old:i,value:s,level:this._level},a=this.dispatchEvent("propertyChanging",n);e?this.data[t]=n.value:n.value=this._set(t,n.value),null!=a&&a.ret.length&&!1===a.ret[0]||(this.dispatchEvent("propertyChanged."+t,n),this.dispatchEvent("propertyChanged",n),this.changedList.push(t))},set:function(){var i=arguments.length,s=!1,e=!1;if((i>2||2==i&&"object"==t.typeOf(arguments[0]))&&"boolean"==t.typeOf(arguments[i-1])&&!1===(s=arguments[--i])&&(e=!0),0==this._level&&(this.changedList=[]),this._level++,2==i)(this.data[arguments[0]]!=arguments[1]||s)&&(this._silent||e?this._set(arguments[0],arguments[1]):this._propertyEvent(arguments[0],this.data[arguments[0]],this._validate(arguments[0],arguments[1])));else for(var n in arguments[0])(this.data[n]!=arguments[0][n]||s)&&(this._silent||e?this._set(n,arguments[0][n]):this._propertyEvent(n,this.data[n],this._validate(n,arguments[0][n])));return--this._level||!this.changedList.length||e||this._silent||this.dispatchEvent("modelChanged",{fields:this.changedList}),this},has:function(t){return t in this.data},get:function(t,i){return 0==arguments.length||!1===t?this.data:1==arguments.length&&!0===t?this.flatten():2==arguments.length&&void 0===this.data[t]?i:this.data[t]},getInt:function(t,i){return 2==arguments.length&&void 0===this.data[t]?i:parseInt(this.data[t])},getFloat:function(t,i){return 2==arguments.length&&void 0===this.data[t]?i:parseFloat(this.data[t])},getBool:function(t,i){return"true"===(t=2==arguments.length&&void 0===this.data[t]?i:this.data[t])||!0===t||"false"!==t&&!1!==t&&!!parseInt(t)},getReference:function(t){var i=this;return{get:function(){return i.get(t)},set:function(s){i.set(t,s)}}},constraint:function(i,s,e){if(3==arguments.length||2==arguments.length||1==arguments.length&&"object"==t.typeOf(i)){switch(this.constraints===this.constructor.prototype.constraints&&(this.constraints=t.clone(this.constraints)),arguments.length){case 1:t.override(this.constraints,i);break;case 2:t.override(this.constraints[i],s);break;case 3:this.constraints[i][s]=e}return this}return i?this.constraints[i]:this},flatten:function(i,s){if(i)return null==(a=this.flatten(!1,!0))?null:(a.class=this.classPath,a);if(!this.constraints&&!this.defaults)return this.data;if(!this.isCompliant())return{};var e=this.constraints,n=this.defaults?"function"==t.typeOf(this.defaults)?this.defaults():this.defaults:this.constraints,a={};for(var r in this.data)if(r in n){if(e&&e[r]){var h=e[r];if(h.model){a[r]=this.data[r]?this.data[r].flatten(s):null;continue}if(h.arrayof){a[r]=[];for(var l=0;l<this.data[r].length;l++)a[r][l]=this.data[r][l]?this.data[r][l].flatten(s):null;continue}if(h.cls){a[r]=this.data[r]?this.data[r].flatten():null;continue}}a[r]=this.data[r]}return a},remove:function(i,s){if("array"==t.typeOf(i)){for(var e=0;e<i.length;e++)delete this.data[i[e]];!1===s||this._silent||this.dispatchEvent("propertyRemoved",{fields:i})}else delete this.data[i],!1===s||this._silent||this.dispatchEvent("propertyRemoved",{fields:[i]})},update:function(i,s){if(this._silent)return this;if(0==this._level&&(this.changedList=[]),this._level++,i&&"string"==t.typeOf(i))this._propertyEvent(i,this.data[i],this.data[i],s);else if(i&&"array"==t.typeOf(i))for(var e of i)this._propertyEvent(e,this.data[e],this.data[e],s);else for(var e in this.data)this._propertyEvent(e,this.data[e],this.data[e],s);return--this._level||this._silent||0==this.changedList.length&&!0!==i||this.dispatchEvent("modelChanged",{fields:this.changedList}),this},validate:function(i){if(!this.constraints)return this;if(i&&"string"==t.typeOf(i))this._set(i,this.data[i]);else for(var s in this.data)i&&-1==t.indexOf(i,s)||this._set(s,this.data[s]);return this},isCompliant:function(){if(!this.constraints)return!0;try{for(var t in this.data)this._validate(t,this.data[t]);return!0}catch(i){}return!1},observe:function(t,i,s){this.addEventListener("propertyChanged."+t,i,s)},unobserve:function(t,i,s){this.removeEventListener("propertyChanged."+t,i,s)},toString:function(){return t.serialize(this.get(!0))}});s.Constraints=require("./model-constraints");
},{"./alpha":"DqrR","./event-dispatcher":"xxCV","./model-constraints":"eGc5"}],"OJpq":[function(require,module,exports) {
let t=require("./alpha"),e=require("./model");module.exports=e.extend({className:"ModelList",itemt:e,contents:null,itemId:null,nextId:null,defaults:{contents:null},constraints:{contents:{type:"array",arrayof:"@itemt"}},ready:function(){this._eventGroup="ModelList_"+Date.now()+":modelChanged",this.contents=this.data.contents},_bind:function(t,e){return e&&e.addEventListener&&e.addEventListener(this._eventGroup,this._onItemEvent,this,t),e},_unbind:function(t){return t&&t.removeEventListener&&t.removeEventListener(this._eventGroup),t},_onItemEvent:function(t,e,n){this.prepareEvent("itemChanged",{id:n,item:t.source}).from(t).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume()},length:function(){return this.data.contents.length},clear:function(){for(var t=0;t<this.data.contents;t++)this._unbind(this.data.contents[t]);this.itemId=[],this.nextId=0,this.data.contents=[],this.prepareEvent("itemsCleared").enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume()},setData:function(e){if(this.clear(),e){for(var n=0;n<e.length;n++){var i=t.ensureTypeOf(this.itemt,e[n]);this.itemId.push(this.nextId++),this.data.contents.push(i),this._bind(this.nextId-1,i)}this.prepareEvent("itemsChanged").enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume()}},getData:function(){return this.data.contents},getAt:function(t){return t<0||t>=this.data.contents.length?null:this.data.contents[t]},removeAt:function(t){if(t<0||t>=this.data.contents.length)return null;let e=this.data.contents.splice(t,1)[0],n=this.itemId.splice(t,1)[0];return this._unbind(e),this.prepareEvent("itemRemoved",{id:n,item:e}).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),e},setAt:function(e,n){return!(e<0||e>=this.data.contents.length)&&(n=t.ensureTypeOf(this.itemt,n),this._unbind(this.data.contents[e]),this.data.contents[e]=n,this._bind(this.itemId[e],n),this.prepareEvent("itemChanged",{id:this.itemId[e],item:n}).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),!0)},updateAt:function(t){return!(t<0||t>=this.data.contents.length)&&(this.prepareEvent("itemChanged",{id:this.itemId[t],item:this.data.contents[t]}).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),!0)},push:function(e){return e&&"object"!=t.typeOf(e)?null:(e=t.ensureTypeOf(this.itemt,e),this.itemId.push(this.nextId++),this.data.contents.push(e),this._bind(this.nextId-1,e),this.prepareEvent("itemAdded",{id:this.itemId[this.itemId.length-1],item:e,position:"tail"}).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),e)},pop:function(){return this._unbind(this.data.contents.pop())},unshift:function(e){return e&&"object"!=t.typeOf(e)?null:(e=t.ensureTypeOf(this.itemt,e),this.itemId.unshift(this.nextId++),this.data.contents.unshift(e),this._bind(this.nextId-1,e),this.prepareEvent("itemAdded",{id:this.itemId[0],item:e,position:"head"}).enqueue(this.prepareEvent("modelChanged",{fields:["contents"]})).resume(),e)},shift:function(){return this._unbind(this.data.contents.shift())},find:function(e,n){for(var i=this.data.contents,s=0;s<i.length;s++)if(t.partialCompare(i[s].data,e))return n?i[s]:s;return n?null:-1}});
},{"./alpha":"DqrR","./model":"UP3c"}],"z45J":[function(require,module,exports) {
let t=require("./alpha"),n=module.exports={Type:function(n){let e={flatten:function(t,n){return t},unflatten:function(t,n){return t}};return n?t.override(e,n):e},String:function(){return n.Type({flatten:function(t,n){return null!=t?t.toString():null},unflatten:function(t,n){return null!=t?t.toString():null}})},Integer:function(){return n.Type({flatten:function(t,n){return~~t},unflatten:function(t,n){return~~t}})},Number:function(t){return n.Type({_precision:t,_round:!1,precision:function(t){return this._precision=~~t,this},flatten:function(t,n){return t=parseFloat(t),this._precision>0&&(t=~~(t*Math.pow(10,this._precision))/Math.pow(10,this._precision)),t},unflatten:function(t,n){return parseFloat(t)}})},Bool:function(t){return n.Type({_compact:t,compact:function(t){return this._compact=t,this},flatten:function(t,n){return t=~~t,this._compact?t>0?1:0:t>0},unflatten:function(t,n){return!!~~t}})},SharedString:function(){return n.Type({flatten:function(t,n){return null==t?0:(t=t.toString(),"strings"in n||(n.strings_map={},n.strings=[]),t in n.strings_map||(n.strings.push(t),n.strings_map[t]=n.strings.length),n.strings_map[t])},unflatten:function(t,n){return null==t||0==t?null:n.strings[~~t-1]}})},Array:function(t){return n.Type({itemType:t,_debug:!1,debug:function(t){return this._debug=t,this},of:function(t){return this.itemType=t,this},flatten:function(t,n){if(null==t)return null;let e=[];for(let r=0;r<t.length;r++)e.push(this.itemType.flatten(t[r],n));return e},unflatten:async function(t,n){if(null==t)return null;let e=[];for(let r=0;r<t.length;r++)e.push(await this.itemType.unflatten(t[r],n));return e}})},Object:function(){return n.Type({properties:[],property:function(t,n,e=null){return this.properties.push({name:t,type:n,defvalue:e}),this},flatten:function(t,n){if(null==t)return null;let e;if(!0===n.symbolic){e={};for(let r=0;r<this.properties.length;r++)e[this.properties[r].name]=this.properties[r].type.flatten(t[this.properties[r].name],n)}else{e=[];for(let r=0;r<this.properties.length;r++)e.push(this.properties[r].type.flatten(t[this.properties[r].name],n))}return e},unflatten:async function(t,n){if(null==t)return null;let e={};if(!0===n.symbolic)for(let r=0;r<this.properties.length;r++)e[this.properties[r].name]=await this.properties[r].type.unflatten(this.properties[r].name in t?t[this.properties[r].name]:this.properties[r].defvalue,n);else for(let r=0;r<this.properties.length;r++)e[this.properties[r].name]=await this.properties[r].type.unflatten(r in t?t[r]:this.properties[r].defvalue,n);return e}})},Class:function(t){return n.Type({_constructor:t,constructor:function(t){return this._constructor=t,this},flatten:function(t,n){return null==t?null:t.flatten(n)},unflatten:async function(t,n){return null==t?null:await(new this._constructor).unflatten(t,n)}})},Property:function(t,e){return n.Type({property:t,type:e,name:function(t){return this.property=t,this},is:function(t){return this.type=t,this},flatten:function(t,n){if(null==t)return null;let e;return!0===n.symbolic?(e={})[this.property]=this.type.flatten(t[this.property],n):e=this.type.flatten(t[this.property],n),e},unflatten:async function(t,n){if(null==t)return null;let e={};return!0===n.symbolic?e[this.property]=await this.type.unflatten(t[this.property],n):e[this.property]=await this.type.unflatten(t,n),e}})},Map:function(){return n.Type({flatten:function(t,n){if(null==t)return null;if(!0===n.symbolic)return t;let e=[];for(let r in t)e.push(r),e.push(t[r]);return e},unflatten:function(t,n){if(null==t)return null;if(!0===n.symbolic)return t;let e={};for(let r=0;r<t.length;r+=2)e[t[r]]=t[r+1];return e}})}};
},{"./alpha":"DqrR"}],"gwLi":[function(require,module,exports) {
let t=require("./class");module.exports=t.extend({className:"Flattenable",typeSchema:null,flatten:function(t){return this.typeSchema.flatten(this,t)},unflatten:async function(t,e){return Object.assign(this,await this.typeSchema.unflatten(t,e)),await this.onUnflattened(),this},onUnflattened:async function(){}});
},{"./class":"voWE"}],"ZP4A":[function(require,module,exports) {
let t=require("./flattenable"),i=require("./schema"),e=require("./alpha");module.exports=t.extend({className:"Collection",itemTypeSchema:null,items:null,__ctor:function(t){t||(t=this.itemTypeSchema),t&&(this.typeSchema=i.Property("items").is(i.Array().of(t))),this.reset()},onUnflattened:function(){let t=this.items;this.reset();for(let i of t)this.add(i)},reset:function(){return this.items=[],this},clear:function(){var t=this.items;this.reset();for(var i=0;i<t.length;i++)this.onItemRemoved(t[i],0);return this},sort:function(t,i){return"function"!=typeof t?this.items.sort(function(e,s){return(e[t]<=s[t]?-1:1)*(!0===i?-1:1)}):this.items.sort(t),this},findItem:function(t,i){if(!this.items)return null;for(var s=0;s<this.items.length;s++)if((!i||!e.partialCompare(this.items[s],i))&&e.partialCompare(this.items[s],t))return this.items[s];return null},getItems:function(){return this.items},length:function(){return this.items.length},isEmpty:function(){return!this.items.length},indexOf:function(t){return this.items.indexOf(t)},getAt:function(t,i=!1){return t<0&&1==i&&(t+=this.items.length),t>=0&&t<this.items.length?this.items[t]:null},first:function(){return this.getAt(0)},last:function(){return this.getAt(-1,!0)},addAt:function(t,i){if(!i||!this.onBeforeItemAdded(i))return this;if(t<0&&(t=0),t>this.items.length&&(t=this.items.length),0==t)this.items.unshift(i);else if(t==this.items.length)this.items.push(i);else{var e=this.items.splice(0,t);e.push(i),this.items=e.concat(this.items)}return this.onItemAdded(i),this},unshift:function(t){return this.addAt(0,t)},push:function(t){return this.addAt(this.items.length,t)},add:function(t){return this.push(t)},removeAt:function(t,i=!1){if(t<0&&1==i&&(t+=this.items.length),t<0||t>=this.items.length)return null;var e=this.items[t];return this.items.splice(t,1),this.onItemRemoved(e,t),e},pop:function(t){return this.removeAt(-1,!0)},shift:function(t){return this.removeAt(0)},remove:function(t){return this.removeAt(this.indexOf(t))},forEach:function(t){if(this.isEmpty())return this;for(var i=0;i<this.items.length&&!1!==t(this.items[i],i,this);i++);return this},forEachCall:function(t,...i){if(this.isEmpty())return this;for(var e=0;e<this.items.length&&!1!==this.items[e][t](...i);e++);return this},forEachRev:function(t){if(this.isEmpty())return this;for(var i=this.items.length-1;i>=0&&!1!==t(this.items[i],i,this);i--);return this},forEachRevCall:function(t,...i){if(this.isEmpty())return this;for(var e=this.items.length-1;e>=0&&!1!==this.items[e][t](...i);e--);return this},onBeforeItemAdded:function(t){return!0},onItemAdded:function(t){},onItemRemoved:function(t){}});
},{"./flattenable":"gwLi","./schema":"z45J","./alpha":"DqrR"}],"iJ0q":[function(require,module,exports) {
let e=require("./alpha"),t=module.exports={strict:!1,parseTemplate:function(r,n,a,l=!1,i=1){let u="string",o=null,f=0,s=0,c="",p=[],g=p,h=!1;function d(r,l){if("template"==r?l=t.parseTemplate(l,n,a,!0,0):"parse"==r?(l=t.parseTemplate(l,n,a,!1,0),r="base-string","array"==e.typeOf(l)&&(r=l[0].type,l=l[0].data)):"parse-trim-merge"==r?l=t.parseTemplate(l.trim().split("\n").map(e=>e.trim()).join("\n"),n,a,!1,0):"parse-merge"==r?l=t.parseTemplate(l,n,a,!1,0):"parse-merge-alt"==r&&(l=t.parseTemplate(l,"{","}",!1,0)),"parse-merge"==r||"parse-merge-alt"==r||"parse-trim-merge"==r)for(let e=0;e<l.length;e++)p.push(l[e]);else p.push({type:r,data:l});h&&(g.push(p=[]),h=!1)}!0===l&&(r=r.trim(),u="identifier",f=10,g.push(p=[])),r+="\0";for(let e=0;e<r.length;e++)if("\\"!=r[e]){switch(f){case 0:"\0"==r[e]?o="string":r[e]==n&&"<"==r[e+1]?(f=1,s=1,o="string",u="parse-merge"):r[e]==n&&"@"==r[e+1]?(f=1,s=1,o="string",u="parse-trim-merge",e++):r[e]==n&&":"==r[e+1]?(f=12,s=1,o="string",u="string",e++):r[e]==n?(f=1,s=1,o="string",u="template"):c+=r[e];break;case 1:if("\0"==r[e])throw new Error("Parse error: Unexpected end of template");if(r[e]==a){if(--s<0)throw new Error("Parse error: Unmatched "+a);if(0==s){f=0,o=u;break}}else r[e]==n&&s++;c+=r[e];break;case 10:if("\0"==r[e]){o=u;break}if("."==r[e]){d(u,c),d("access","."),u="identifier",c="";break}if(null!=r[e].match(/[\t\n\r\f\v ]/)){for(o=u,u="identifier",h=!0;null!=r[e].match(/[\t\n\r\f\v ]/);)e++;e--;break}if(r[e]==n&&"<"==r[e+1]){c&&(o=u),f=11,s=1,u="parse-merge";break}if(r[e]==n&&"@"==r[e+1]){c&&(o=u),f=11,s=1,u="parse-trim-merge",e++;break}if('"'==r[e]){c&&(o=u),f=14,s=1,u="parse-merge";break}if("'"==r[e]){c&&(o=u),f=15,s=1,u="parse-merge";break}if("`"==r[e]){c&&(o=u),f=16,s=1,u="parse-merge-alt";break}if(r[e]==n&&":"==r[e+1]){c&&(o=u),f=13,s=1,u="string",e++;break}if(r[e]==n){c&&d(u,c),f=11,s=1,c="",u="parse",c+=r[e];break}"identifier"!=u&&(d(u,c),c="",u="identifier"),c+=r[e];break;case 11:if("\0"==r[e])throw new Error("Parse error: Unexpected end of template");if(r[e]==a){if(--s<0)throw new Error("Parse error: Unmatched "+a);if(0==s&&(f=10,"parse-merge"==u||"parse-merge-alt"==u||"parse-trim-merge"==u))break}else r[e]==n&&s++;c+=r[e];break;case 12:if("\0"==r[e])throw new Error("Parse error: Unexpected end of template");if(r[e]==a){if(--s<0)throw new Error("Parse error: Unmatched "+a);if(0==s){0!=c.length&&"<"!=c[0]&&"["!=c[0]&&" "!=c[0]&&(c=n+c+a),f=0,o=u;break}}else r[e]==n&&s++;c+=r[e];break;case 13:if("\0"==r[e])throw new Error("Parse error: Unexpected end of template");if(r[e]==a){if(--s<0)throw new Error("Parse error: Unmatched "+a);if(0==s){"<"!=c[0]&&"["!=c[0]&&" "!=c[0]&&(c=n+c+a),f=10;break}}else r[e]==n&&s++;c+=r[e];break;case 14:if("\0"==r[e])throw new Error("Parse error: Unexpected end of template");if('"'==r[e]){if(--s<0)throw new Error('Parse error: Unmatched "');if(0==s&&(f=10,"parse-merge"==u||"parse-merge-alt"==u||"parse-trim-merge"==u))break}c+=r[e];break;case 15:if("\0"==r[e])throw new Error("Parse error: Unexpected end of template");if("'"==r[e]){if(--s<0)throw new Error("Parse error: Unmatched '");if(0==s&&(f=10,"parse-merge"==u||"parse-merge-alt"==u||"parse-trim-merge"==u))break}c+=r[e];break;case 16:if("\0"==r[e])throw new Error("Parse error: Unexpected end of template");if("`"==r[e]){if(--s<0)throw new Error("Parse error: Unmatched `");if(0==s&&(f=10,"parse-merge"==u||"parse-merge-alt"==u||"parse-trim-merge"==u))break}c+=r[e]}o&&(d(o,c),o=c="")}else c+="\\",c+=r[++e];if(!l){let e=0;for(;e<g.length&&"string"==g[e].type&&""==g[e].data;)g.splice(e,1);for(e=g.length-1;e>0&&"string"==g[e].type&&""==g[e].data;)g.splice(e--,1);0==g.length&&g.push({type:"string",data:""})}return i&&function e(t){if("object"==typeof t){if(t instanceof Array)for(let r=0;r<t.length;r++)e(t[r]);else t.data=e(t.data);return t}for(let r=0;r<t.length;r++)if("\\"==t[r]){let e=t[r+1];switch(e){case"n":e="\n";break;case"r":e="\r";break;case"f":e="\f";break;case"v":e="\v";break;case"t":e="\t";break;case"s":e="s";break;case'"':e='"';break;case"'":e="'"}t=t.substr(0,r)+e+t.substr(r+2)}return t}(g),g},parse:function(e){return this.parseTemplate(e.trim(),"[","]",!1)},clean:function(e){for(let t=0;t<e.length;t++)"template"!=e[t].type&&(e.splice(t,1),t--);return e},expand:function(r,n,a="text",l="base-string"){let i=[];if("var"==l){let e=!0,a=!1,l=n,u=null,o=!0,f="";for(let i=0;i<r.length&&null!=n;i++)switch(r[i].type){case"identifier":case"string":f+=r[i].data,u=null;break;case"template":f+="object"!=typeof(u=this.expand(r[i].data,l,"arg","template"))?u:"";break;case"base-string":f+=this.expand(r[i].data,l,"arg","base-string"),u=null;break;case"access":if(u&&"object"==typeof u)n=u;else{for(f||(f="this");;)if("!"==f[0])f=f.substr(1),e=!1;else{if("$"!=f[0])break;f=f.substr(1),a=!0}if("this"!=f&&null!=n){let e=n;null===(n=f in n?n[f]:null)&&o&&f in t.functions&&(n=t.functions[f](null,null,e)),o=!1}}f=""}for(;""!=f;)if("!"==f[0])f=f.substr(1),e=!1;else{if("$"!=f[0])break;f=f.substr(1),a=!0}if("this"!=f){let e=!1;if(null!=n?f in n?n=n[f]:(e=!0,n=null):e=!0,e&&1==r.length&&1==t.strict)throw new Error("Expression function `"+f+"` not found.")}"string"==typeof n&&(e&&(n=n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),a&&(n='"'+n+'"')),i.push(n)}if("varref"==a){let e=n,a=null,l=!0,i="";for(let u=0;u<r.length&&null!=n;u++)switch(r[u].type){case"identifier":case"string":i+=r[u].data,a=null;break;case"template":i+="object"!=typeof(a=this.expand(r[u].data,e,"arg","template"))?a:"";break;case"base-string":i+=this.expand(r[u].data,e,"arg","base-string"),a=null;break;case"access":if(a&&"object"==typeof a)n=a;else{for(i||(i="this");;)if("!"==i[0])i=i.substr(1);else{if("$"!=i[0])break;i=i.substr(1)}if("this"!=i&&null!=n){let e=n;null===(n=i in n?n[i]:null)&&l&&i in t.functions&&(n=t.functions[i](null,null,e)),l=!1}}i=""}for(;""!=i;)if("!"==i[0])i=i.substr(1);else{if("$"!=i[0])break;i=i.substr(1)}return"this"!=i?[n,i]:null}if("fn"==l){var u=[];if(u.push(t.expand(r[0],n,"text","base-string")),"_"+u[0]in t.functions&&(u[0]="_"+u[0]),!(u[0]in t.functions)){if(1==t.strict)throw new Error("Expression function `"+u[0]+"` not found.");return`(Unknown: ${u[0]})`}if("_"==u[0][0])return t.functions[u[0]](r,n);for(let e=1;e<r.length;e++)u.push(t.expand(r[e],n,"arg","base-string"));i.push(t.functions[u[0]](u,r,n))}if("template"==l){if(1==r.length){if(1==r[0].length&&"string"==r[0][0].type)return r[0][0].data;if(1==r[0].length&&"identifier"==r[0][0].type){let e=r[0][0].data;if(e in t.functions||"_"+e in t.functions)return t.expand(r,n,a,"fn")}return t.expand(r[0],n,a,"var")}return t.expand(r,n,a,"fn")}if("base-string"==l){let e=-1;for(let l of r){let u=null;switch(e++,l.type){case"template":u=t.expand(l.data,n,a,"template");break;case"string":case"identifier":u=l.data;break;case"base-string":u=t.expand(l.data,n,a,"base-string")}"void"!=a&&("last"==a&&e!=r.length-1||i.push(u))}}if("obj"==a)return i;if("last"==a)return"Rose\\Arry"==typeOf(i)&&(i=i[0]),i;if("void"==a)return null;if("arg"==a)return"array"==e.typeOf(i)?1!=i.length?i.join(""):i[0]:i;if("text"==a&&"array"==e.typeOf(i)){let e=t=>null!=t&&"object"==typeof t?"map"in t?t.map(e).join(""):"join"in t?t.join(""):t.toString():t;i=i.map(e).join("")}return i},compile:function(e){return e=t.parse(e),function(r=null,n="text"){return t.expand(e,r||{},n)}},eval:function(e,r=null,n="text"){return e=t.parse(e),t.expand(e,r||{},n)},value:function(r,n=null){return"array"!=e.typeOf(r)?r:t.expand(r,n||{},"arg")},register:function(e,r){t.functions[e]=r},call:function(e,r,n=null){return e in t.functions?t.functions[e](r,null,n):null},getNamedValues:function(e,r,n=1,a=!0){let l={},i=0;for(;n<e.length;n+=2){let u=t.expand(e[n],r,"arg");i||(i=u.startsWith(":")?1:u.endsWith(":")?2:3),1==i?u=u.substr(1):2==i&&(u=u.substr(0,u.length-1)),l[u]=a?t.expand(e[n+1],r,"arg"):e[n+1]}return l}};t.functions={null:function(e){return null},true:function(e){return!0},false:function(e){return!1},len:function(e){return e[1].toString().length},int:function(e){return~~e[1]},str:function(e){return e[1].toString()},float:function(e){return parseFloat(e[1])},chr:function(e){return String.fromCharCode(e[1])},ord:function(e){return e[1].toString().charCodeAt(0)},not:function(e){return!e[1]},neg:function(e){return-e[1]},abs:function(e){return Math.abs(e[1])},and:function(e){for(let t=1;t<e.length;t++)if(!e[t])return!1;return!0},or:function(e){for(let t=1;t<e.length;t++)if(~~e[t])return!0;return!1},eq:function(e){return e[1]==e[2]},ne:function(e){return e[1]!=e[2]},lt:function(e){return e[1]<e[2]},le:function(e){return e[1]<=e[2]},gt:function(e){return e[1]>e[2]},ge:function(e){return e[1]>=e[2]},isnotnull:function(e){return!!e[1]},isnull:function(e){return!e[1]},iszero:function(e){return 0==parseInt(e[1])},"eq?":function(e){return e[1]==e[2]},"ne?":function(e){return e[1]!=e[2]},"lt?":function(e){return e[1]<e[2]},"le?":function(e){return e[1]<=e[2]},"gt?":function(e){return e[1]>e[2]},"ge?":function(e){return e[1]>=e[2]},"notnull?":function(e){return!!e[1]},"null?":function(e){return!e[1]},"zero?":function(e){return 0==parseInt(e[1])},typeof:function(t){return e.typeOf(t[1])},"*":function(e){let t=e[1];for(let r=2;r<e.length;r++)t*=e[r];return t},"/":function(e){let t=e[1];for(let r=2;r<e.length;r++)t/=e[r];return t},"+":function(e){let t=e[1];for(let r=2;r<e.length;r++)t-=-e[r];return t},"-":function(e){let t=e[1];for(let r=2;r<e.length;r++)t-=e[r];return t},mul:function(e){let t=e[1];for(let r=2;r<e.length;r++)t*=e[r];return t},div:function(e){let t=e[1];for(let r=2;r<e.length;r++)t/=e[r];return t},sum:function(e){let t=e[1];for(let r=2;r<e.length;r++)t-=-e[r];return t},sub:function(e){let t=e[1];for(let r=2;r<e.length;r++)t-=e[r];return t},mod:function(e){let t=e[1];for(let r=2;r<e.length;r++)t%=e[r];return t},pow:function(e){let t=e[1];for(let r=2;r<e.length;r++)t=Math.pow(t,e[r]);return t},json:function(e){return JSON.stringify(e[1])},_set:function(e,r){for(let n=1;n+1<e.length;n+=2){let a=t.value(e[n+1],r);if(e[n].length>1){let l=t.expand(e[n],r,"varref");null!=l&&(l[0][l[1]]=a)}else r[t.value(e[n],r)]=a}return""},_unset:function(e,r){for(let n=1;n<e.length;n++)if(e[n].length>1){let a=t.expand(e[n],r,"varref");null!=a&&delete a[0][a[1]]}else delete r[t.value(e[n],r)];return null},trim:function(e){return e[1]?"object"==typeof e[1]?e[1].map(e=>e.trim()):e[1].trim():""},upper:function(e){return e[1]?"object"==typeof e[1]?e[1].map(e=>e.toUpperCase()):e[1].toUpperCase():""},lower:function(e){return e[1]?"object"==typeof e[1]?e[1].map(e=>e.toLowerCase()):e[1].toLowerCase():""},substr:function(e){let t=e[e.length-1].toString(),r=0,n=null;return 4==e.length?(r=~~e[1],n=~~e[2]):(r=~~e[1],n=null),r<0&&(r+=t.length),n<0&&(n+=t.length),null===n&&(n=t.length-r),t.substr(r,n)},replace:function(e){return e[3].split(e[1]).join(e[2])},nl2br:function(e){return e[1]?"object"==typeof e[1]?e[1].map(e=>e.replace(/\n/g,"<br/>")):e[1].replace(/\n/g,"<br/>"):""},"%":function(t){t.shift();var r=t.shift();let n="";for(let a=0;a<t.length;a++)if("array"==e.typeOf(t[a])){n+=`<${r}>`;for(let e=0;e<t[a].length;e++)n+=t[a][e];n+=`</${r}>`}else n+=`<${r}>${t[a]}</${r}>`;return n},"%%":function(e){e.shift();var t=e.shift();let r="",n="";for(let a=0;a<e.length;a+=2)a+1<e.length?r+=` ${e[a]}="${e[a+1]}"`:n=e[a];return n?`<${t}${r}>${n}</${t}>`:`<${t}${r}/>`},join:function(t){return t[2]&&"array"==e.typeOf(t[2])?t[2].join(t[1]):""},split:function(e){return e[2]&&"string"==typeof e[2]?e[2].split(e[1]):[]},keys:function(e){return e[1]&&"object"==typeof e[1]?Object.keys(e[1]):[]},values:function(e){return e[1]&&"object"==typeof e[1]?Object.values(e[1]):[]},_each:function(e,r){let n=t.expand(e[1],r,"arg"),a=t.expand(e[2],r,"arg"),l=[],i=0;if(!a)return l;for(let u in a)r[n]=a[u],r[n+"##"]=i++,r[n+"#"]=u,l.push(t.expand(e[3],r,"text"));return delete r[n],delete r[n+"##"],delete r[n+"#"],l},_foreach:function(e,r){let n=t.expand(e[1],r,"arg"),a=t.expand(e[2],r,"arg"),l=0;if(!a)return null;for(let i in a)r[n]=a[i],r[n+"##"]=l++,r[n+"#"]=i,t.expand(e[3],r,"text");return delete r[n],delete r[n+"##"],delete r[n+"#"],null},"_?":function(e,r){return t.expand(e[1],r,"arg")?t.expand(e[2],r,"arg"):e.length>3?t.expand(e[3],r,"arg"):""},"_??":function(e,r){let n=t.expand(e[1],r,"arg");return n||t.expand(e[2],r,"arg")},_if:function(e,r){for(let n=0;n<e.length;n+=3){if("else"==t.expand(e[n],r,"arg"))return t.expand(e[n+1],r,"text");if(t.expand(e[n+1],r,"arg"))return t.expand(e[n+2],r,"text")}return""},_switch:function(e,r){let n=t.expand(e[1],r,"arg");for(let a=2;a<e.length;a+=2){let l=t.expand(e[a],r,"arg");if(l==n||"default"==l)return t.expand(e[a+1],r,"text")}return""},_break:function(e,t){throw new Error("EXC_BREAK")},_continue:function(e,t){throw new Error("EXC_CONTINUE")},_repeat:function(e,r){if(e.length<3||1!=(1&e.length))return"(`repeat`: Wrong number of parameters)";let n=t.value(e[1],r),a=null,l=0,i=null,u=null;for(let c=2;c<e.length-1;c+=2){switch(t.value(e[c],r).toLowerCase()){case"from":l=parseFloat(t.value(e[c+1],r));break;case"to":i=parseFloat(t.value(e[c+1],r));break;case"count":a=parseFloat(t.value(e[c+1],r));break;case"step":u=parseFloat(t.value(e[c+1],r))}}let o=e[e.length-1],f=[];if(null!==i)if(null===u&&(u=l>i?-1:1),u<0)for(let c=l;c>=i;c+=u)try{r[n]=c,f.push(t.value(o,r))}catch(s){let e=s.message;if("EXC_BREAK"==e)break;if("EXC_CONTINUE"==e)continue;throw s}else for(let c=l;c<=i;c+=u)try{r[n]=c,f.push(t.value(o,r))}catch(s){let e=s.message;if("EXC_BREAK"==e)break;if("EXC_CONTINUE"==e)continue;throw s}else if(null!==a){null===u&&(u=1);for(let e=l;a>0;a--,e+=u)try{r[n]=e,f.push(t.value(o,r))}catch(s){let e=s.message;if("EXC_BREAK"==e)break;if("EXC_CONTINUE"==e)continue;throw s}}else{null===u&&(u=1);for(let e=l;;e+=u)try{r[n]=e,f.push(t.value(o,r))}catch(s){let e=s.message;if("EXC_BREAK"==e)break;if("EXC_CONTINUE"==e)continue;throw s}}return delete r[n],f},_for:function(e,r){if(e.length<3||1!=(1&e.length))return"(`for`: Wrong number of parameters)";let n=t.value(e[1],r),a=null,l=0;to=null;let i=null;for(let f=2;f<e.length-1;f+=2)switch(value=t.value(e[f],r),value.toLowerCase()){case"from":l=parseFloat(t.value(e[f+1],r));break;case"to":to=parseFloat(t.value(e[f+1],r));break;case"count":a=parseFloat(t.value(e[f+1],r));break;case"step":i=parseFloat(t.value(e[f+1],r))}let u=e[e.length-1];if(null!==to)if(null===i&&(i=l>to?-1:1),i<0)for(let f=l;f>=to;f+=i)try{r[n]=f,t.value(u,r)}catch(o){let e=o.message;if("EXC_BREAK"==e)break;if("EXC_CONTINUE"==e)continue;throw o}else for(let f=l;f<=to;f+=i)try{r[n]=f,t.value(u,r)}catch(o){let e=o.message;if("EXC_BREAK"==e)break;if("EXC_CONTINUE"==e)continue;throw o}else if(null!==a){null===i&&(i=1);for(let e=l;a>0;a--,e+=i)try{r[n]=e,t.value(u,r)}catch(o){let e=o.message;if("EXC_BREAK"==e)break;if("EXC_CONTINUE"==e)continue;throw o}}else{null===i&&(i=1);for(let e=l;;e+=i)try{r[n]=e,t.value(u,r)}catch(o){let e=o.message;if("EXC_BREAK"==e)break;if("EXC_CONTINUE"==e)continue;throw o}}return delete r[n],null},_loop:function(e,r){if(e.length<2)return"(`loop`: Wrong number of parameters)";let n=e[1];for(;;)try{t.value(n,r)}catch(a){let e=a.message;if("EXC_BREAK"==e)break;if("EXC_CONTINUE"==e)continue;throw a}return null},_echo:function(e,r){let n="";for(let a=1;a<e.length;a++)n+=t.expand(e[a],r,"arg");return console.log(n),""},"_#":function(e,r){let n=[];for(let a=1;a<e.length;a++)n.push(t.expand(e[a],r,"arg"));return n},"_##":function(e,t){let r=[];for(let n=1;n<e.length;n++)r.push(e[n]);return r},"_&":function(e,r){return t.getNamedValues(e,r,1,!0)},"_&&":function(e,r){return t.getNamedValues(e,r,1,!1)},contains:function(e,t,r){let n=e[1];if("object"!=typeof n)return r.err="Argument is not a Map",!1;let a="";for(let l=2;l<e.length;l++)e[l]in n||(a+=", "+e[l]);return""==a||(r.err=a.substr(1),!1)},has:function(t,r,n){let a=t[2];return"object"==e.typeOf(a)&&t[1]in a},_map:function(r,n){let a=t.expand(r[1],n,"arg"),l=t.expand(r[2],n,"arg");if(!l)return l;let i="array"==e.typeOf(l),u=i?[]:{},o=0;for(let e in l)n[a]=l[e],n[a+"##"]=o++,n[a+"#"]=e,i?u.push(t.expand(r[3],n,"arg")):u[e]=t.expand(r[3],n,"arg");return delete n[a],delete n[a+"##"],delete n[a+"#"],u},_filter:function(r,n){let a=t.expand(r[1],n,"arg"),l=t.expand(r[2],n,"arg");if(!l)return l;let i="array"==e.typeOf(l),u=i?[]:{},o=0;for(let e in l)n[a]=l[e],n[a+"##"]=o++,n[a+"#"]=e,~~t.expand(r[3],n,"arg")&&(i?u.push(l[e]):u[e]=l[e]);return delete n[a],delete n[a+"##"],delete n[a+"#"],u},expand:function(e,r,n){return t.expand(t.parseTemplate(e[1],"{","}"),3==e.length?e[2]:n)},_call:function(e,r){let n=t.expand(e[1],r,"varref");if(!n||"function"!=typeof n[0][n[1]])throw new Error("Expression is not a function: "+t.expand(e[1],r,"obj").map(e=>null==e?".":e).join(""));let a=[];for(let l=2;l<e.length;l++)a.push(t.value(e[l],r));return n[0][n[1]](...a)}};
},{"./alpha":"DqrR"}],"MJTl":[function(require,module,exports) {
let e=require("./alpha");e.Rin=e,e.Class=require("./class"),e.Event=require("./event"),e.EventDispatcher=require("./event-dispatcher"),e.Model=require("./model"),e.ModelList=require("./model-list"),e.Schema=require("./schema"),e.Flattenable=require("./flattenable"),e.Collection=require("./collection"),e.Template=require("./template"),Object.assign(module.exports,e);
},{"./alpha":"DqrR","./class":"voWE","./event":"C33R","./event-dispatcher":"xxCV","./model":"UP3c","./model-list":"OJpq","./schema":"z45J","./flattenable":"gwLi","./collection":"ZP4A","./template":"iJ0q"}],"hPM2":[function(require,module,exports) {
const{EventDispatcher:t}=require("@rsthn/rin");let e=module.exports={Route:t.extend({routeRegex:null,value:null,params:null,s_args:null,active:!1,changed:!1,__ctor:function(t){this._super.EventDispatcher.__ctor(),this._compileRoute(this.value=t)},_compileRoute:function(t){for(this.params=[];;){var e=/:([!@A-Za-z0-9_-]+)/.exec(t);if(!e)break;t=t.replace(e[0],"([^/]+)"),this.params.push(e[1])}this.routeRegex="^"+t.replace(/##/g,"")},addHandler:function(t,e){this.addEventListener((!0===e?"un":"")+"routed",t,null)},removeHandler:function(t,e){this.removeEventListener((!0===e?"un":"")+"routed",t,null)},dispatch:function(t){var e=t.match(this.routeRegex);if(!e)return this.s_args=null,this.active&&this.dispatchEvent("unrouted",{route:this}),void(this.active=!1);for(var s={route:this},i="",o=0;o<this.params.length;o++)s[this.params[o]]=e[o+1],i+="_"+e[o+1];this.changed=i!=this.s_args,this.dispatchEvent("routed",s),this.s_args=i,this.active=!0}}),routes:{},sortedRoutes:[],ignoreHashChangeEvent:0,location:"",args:[],init:function(){this.alreadyAttached||(this.alreadyAttached=!0,"onhashchange"in globalThis&&(globalThis.onhashchange=this.onLocationChanged.bind(this)))},refresh:function(){this.onLocationChanged()},setRoute:function(t,e){var s=this.realLocation(t);s!=this.location&&(e&&this.ignoreHashChangeEvent++,globalThis.location.hash=s)},addRoute:function(t,e,s){this.routes[t]||(this.routes[t]=new this.Route(t),this.sortedRoutes.push(t),this.sortedRoutes.sort((t,e)=>this.routes[t].routeRegex.length-this.routes[e].routeRegex.length)),void 0!==s?(this.routes[t].addHandler(e,!1),this.routes[t].addHandler(s,!0)):this.routes[t].addHandler(e,!1)},addRoutes:function(t){for(var e in t)this.routes[e]||(this.routes[e]=new this.Route(e),this.sortedRoutes.push(e)),this.routes[e].addHandler(t[e],!1);this.sortedRoutes.sort((t,e)=>this.routes[t].routeRegex.length-this.routes[e].routeRegex.length)},removeRoute:function(t,e,s){this.routes[t]&&(void 0!==s?(this.routes[t].removeHandler(e,!1),this.routes[t].removeHandler(s,!0)):this.routes[t].removeHandler(e))},removeRoutes:function(t){for(var e in t)this.routes[e]&&this.routes[e].removeHandler(t[e])},realLocation:function(t,e){e||(e=this.location),e||(e=" ");for(var s,i=0,o=0,r=0,a="";-1!=i&&o<t.length&&r<e.length;)switch(i){case 0:if("*"==t.substr(o++,1)){i=1;break}if(t.substr(o-1,1)!=e.substr(r++,1)){a+=t.substr(o-1),i=-1;break}a+=e.substr(r-1,1);break;case 1:if("*"==t.substr(o,1)){i=3,o++;break}i=2;break;case 2:if(-1==(s=e.indexOf(t.substr(o,1),r))){a+=e.substr(r)+t.substr(o),i=-1;break}a+=e.substr(r,s-r),i=0,r=s;break;case 3:if(-1==(s=e.lastIndexOf(t.substr(o,1)))){a+=t.substr(o),i=-1;break}a+=e.substr(r,s-r),i=0,r=s}return-1!=i&&(a+=t.substr(o)),a.trim()},onLocationChanged:function(){var t=location.hash.substr(1),e=this.realLocation(t);if(t==e)if(this.location=t,this.args=this.location.split("/"),this.ignoreHashChangeEvent>0)this.ignoreHashChangeEvent--;else for(var s=0;s<this.sortedRoutes.length;s++)this.routes[this.sortedRoutes[s]].dispatch(this.location);else globalThis.location.replace("#"+e)},navigate:function(t,e=!1){t=this.realLocation(t),globalThis.location.hash!="#"+t?e?globalThis.location.replace("#"+t):globalThis.location.hash=t:this.refresh()}};e.init();
},{"@rsthn/rin":"MJTl"}],"yFRv":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3];const{Rin:e,Model:i,Template:s}=require("@rsthn/rin"),n={},r={},o=module.exports={eid:null,isRoot:!0,root:null,isReady:0,refs:null,modelt:i,model:null,events:{"click [data-action]":function(t){let e=t.source.dataset.action.split(" ");e[0]in this?this[e[0]]({...t.source.dataset,...e},t):t.continuePropagation=!0},"keyup(13) input[data-enter]":function(t){let e=t.source.dataset.enter.split(" ");e[0]in this?this[e[0]]({...t.source.dataset,...e},t):t.continuePropagation=!0}},__ctor:function(){if(this._list_watch=[],this._list_visible=[],this._list_property=[],this.style.display="block",this.refs={},this.eid=Math.random().toString().substr(2),null!=this.model){let t=this.model;this.model=null,this.setModel(t,!1)}this._mutationObserver=!0,this.init(),Object.keys(this._super).reverse().forEach(t=>{"init"in this._super[t]&&this._super[t].init()}),this.events&&this.bindEvents(this.events);const t=()=>{if(this.ready(),this.isReady=1,"model"in this.dataset){let t=this.getFieldByPath(this.dataset.model);t&&this.setModel(t)}Object.keys(this._super).reverse().forEach(t=>{"ready"in this._super[t]&&this._super[t].ready()}),this.collectWatchers();let t=this.findCustomParent(this);return t&&(t._mutationHandler?t._mutationHandler():2==t.isReady&&(this.rready(),this.isReady=2)),t};let e=null;this._mutationHandler=(()=>{if(0==this.childNodes.length)return;this.querySelectorAll("[data-_pending=true]").forEach(t=>{this.findRoot(t.parentElement)===this&&t.connectReference(this)});let i=!0;this.querySelectorAll("[data-_custom]").forEach(t=>{this.findCustomParent(t)===this&&(t.isReady||(i=!1))}),i&&(e&&clearTimeout(e),e=setTimeout(()=>{e=null;let i=!0,s=[];if(this.querySelectorAll("[data-_custom]").forEach(t=>{this.findCustomParent(t)===this&&(t.isReady||(i=!1),2!=t.isReady&&s.push(t))}),!i)return;for(let t of this.querySelectorAll("[data-_pending=true]"))console.log("FOUND ELEMENT "+t.tagName),"true"!=t.dataset._linked&&(this[t.dataset.ref]=t,this.refs[t.dataset.ref]=t,t.dataset._linked="true",t.root=this,this.onRefAdded(t.dataset.ref));this._mutationHandler=null,this._mutationObserver.disconnect(),this._mutationObserver=null;let n=t();for(let t of s)t.rready(),t.isReady=2;n||(this.isReady=2,this.rready())},50))}),this._mutationObserver=new MutationObserver(this._mutationHandler),this._mutationObserver.observe(this,{attributes:!1,childList:!0,subtree:!1}),this._mutationHandler()},init:function(){},ready:function(){},rready:function(){},getFieldByPath:function(e){if(!e)return null;let i=e.split("."),s=t;for(i.length&&"this"==i[0]&&(s=this,i.shift());null!=s&&0!=i.length;)s=s[i.shift()];return s},getRoot:function(){return this.root?this.root:this.root=this.findRoot()},setModel:function(t,i){return t?(t=e.ensureTypeOf(this.modelt,t),this.model!==t&&(null!=this.model&&(this.model.removeEventListener(this.eid+":modelChanged",this.onModelPreChanged,this),this.model.removeEventListener(this.eid+":propertyChanging",this.onModelPropertyChanging,this),this.model.removeEventListener(this.eid+":propertyChanged",this.onModelPropertyPreChanged,this),this.model.removeEventListener(this.eid+":propertyRemoved",this.onModelPropertyRemoved,this)),this.model=t,this.model.addEventListener(this.eid+":modelChanged",this.onModelPreChanged,this),this.model.addEventListener(this.eid+":propertyChanging",this.onModelPropertyChanging,this),this.model.addEventListener(this.eid+":propertyChanged",this.onModelPropertyPreChanged,this),this.model.addEventListener(this.eid+":propertyRemoved",this.onModelPropertyRemoved,this)),!1!==i&&this.model.setNamespace(this.eid).update(!0).setNamespace(null),this):this},getModel:function(){return this.model},addClass:function(t){return t.split(" ").forEach(t=>this.classList.add(t.trim())),this},removeClass:function(t){return t.split(" ").forEach(t=>this.classList.remove(t.trim())),this},setStyle:function(t){return t?(t.split(";").forEach(t=>{let e=(t=t.trim()).indexOf(":");if(-1==e)return;let i=t.substr(0,e).trim();for(let s=i.indexOf("-");-1!=s;s=i.indexOf("-"))i=i.substr(0,s)+i.substr(s+1,1).toUpperCase()+i.substr(s+2);this.style[i]=t.substr(e+1).trim()}),this):this},getWidth:function(t){return(t||this).getBoundingClientRect().width},getHeight:function(t){return(t||this).getBoundingClientRect().height},bindEvents:function(t){for(var i in t){let l=t[i];"string"==e.typeOf(l)&&(l=this[l]),l=l.bind(this);var s=i.indexOf(" "),n=-1==s?i:i.substr(0,s),r=-1==s?"":i.substr(s+1);let a=null;var o=n.indexOf("(");if(-1!=o&&(a=n.substr(o+1,n.length-o-2).split(","),n=n.substr(0,o)),"@"==r.substr(0,1)){if("this"!=r.substr(1)){this[r.substr(1)].addEventListener(n,l);continue}r=this}if("#"!=n.substr(0,1)){if(null!=a)switch(n){case"keyup":case"keydown":this.listen(n,r,function(t){if(-1!=e.indexOf(a,t.keyCode.toString()))return l(t,a);t.continuePropagation=!0});continue}this.listen(n,r,l)}else this.listen("propertyChanged."+n.substr(1),this,l)}return this},_eventHandler:function(t,i,s){if(!1!==t.continuePropagation){if(t.continuePropagation=!0,t.source=t.target,i&&i instanceof HTMLElement)t.source===i&&(t.continuePropagation=!1,s.call(this,t,t.detail));else if(i&&"*"!=i){let n=this.querySelectorAll(i);for(;t.source!==this;){if(-1!==e.indexOf(n,t.source,!0)){t.continuePropagation=!1,s.call(this,t,t.detail);break}t.source=t.source.parentElement}}else t.continuePropagation=!1,s.call(this,t,t.detail);!1===t.continuePropagation&&(t.preventDefault(),t.stopPropagation())}},listen:function(t,i,s){let n=!1;"function"==e.typeOf(i)&&(s=i,i=null),"!"==t[t.length-1]&&(t=t.substr(0,t.length-1),n=!0);let r=null,o=null,l=this;return this.addEventListener(t,r=(t=>{!1!==t.continuePropagation&&(t.firstCapture||(t.firstCapture=this,t.firstCaptureCount=0,t.queue=[]),t.firstCapture===this&&t.firstCaptureCount++,1!=n||t.queue.push([this,i,s]))}),!0),this.addEventListener(t,o=(t=>{if(!1!==t.continuePropagation&&(1!=n&&this._eventHandler(t,i,s),t.firstCapture===this&&!1!==t.continuePropagation&&0==--t.firstCaptureCount)){for(;t.queue.length;){let e=t.queue.pop();e[0]._eventHandler(t,e[1],e[2])}t.continuePropagation=!1}}),!1),{removed:!1,remove:function(){this.removed||(this.removed=!0,l.removeEventListener(t,r,!0),l.removeEventListener(t,o,!1))}}},dispatch:function(t,e=null,i=!0){this.dispatchEvent(new CustomEvent(t,{bubbles:i,detail:e}))},dispatchOn:function(t,e,i=null,s=!0){t.dispatchEvent(new CustomEvent(e,{bubbles:s,detail:i}))},setInnerHTML:function(t){if(null==this._mutationObserver){let t=null;this._mutationHandler=(()=>{if(0==this.childNodes.length)return;let e=!0;this.querySelectorAll("[data-_custom]").forEach(t=>{this.findCustomParent(t)===this&&(t.isReady||(e=!1))}),e&&(t&&clearTimeout(t),t=setTimeout(()=>{t=null;let e=!0,i=[];if(this.querySelectorAll("[data-_custom]").forEach(t=>{this.findCustomParent(t)===this&&(t.isReady||(e=!1),2!=t.isReady&&i.push(t))}),e){this._mutationHandler=null,this._mutationObserver.disconnect(),this._mutationObserver=null;for(let t of i)t.rready(),t.isReady=2;this.collectWatchers()}},50))}),this._mutationObserver=new MutationObserver(this._mutationHandler),this._mutationObserver.observe(this,{attributes:!1,childList:!0,subtree:!1})}this.innerHTML=t},collectWatchers:function(){let t,e=this,i=!1,n=this._list_watch.length,r=this._list_visible.length,o=this._list_property.length;t=this.querySelectorAll("[data-watch]");for(let l=0;l<t.length;l++){for(let e of t[l].querySelectorAll(".pseudo"))e.remove();t[l]._template=s.compile(t[l].innerHTML),t[l]._watch=new RegExp("^("+t[l].dataset.watch+")$"),t[l].innerHTML="",t[l].removeAttribute("data-watch"),this._list_watch.push(t[l])}if("selfWatch"in this.dataset){for(let t of this.querySelectorAll(".pseudo"))t.remove();this._template=s.compile(this.innerHTML),this._watch=new RegExp("^("+this.dataset.selfWatch+")$"),this.innerHTML="",this.removeAttribute("data-self-watch"),this._list_watch.push(this)}t=this.querySelectorAll("[data-visible]");for(let l=0;l<t.length;l++)t[l]._visible=s.compile(t[l].dataset.visible),t[l].removeAttribute("data-visible"),this._list_visible.push(t[l]);"selfVisible"in this.dataset&&(this._visible=s.compile(this.dataset.selfVisible),this.removeAttribute("data-self-visible"),this._list_visible.push(this)),t=this.querySelectorAll("[data-property]");for(let s=0;s<t.length;s++)t[s].onchange=t[s].onblur=function(){switch(this.type){case"radio":this.checked&&e.getModel().set(this.name,this.value);break;case"checkbox":e.getModel().set(this.name,this.checked?"1":"0");break;case"field":e.getModel().set(this.name,this.getValue());break;default:e.getModel().set(this.name,this.value)}},"SELECT"==t[s].tagName&&(t[s].onmouseup=function(){e.getModel().set(this.name,this.value)}),t[s].name=t[s].dataset.property,t[s].removeAttribute("data-property"),this._list_property.push(t[s]);"selfProperty"in this.dataset&&(this.onchange=this.onblur=function(){switch(this.type){case"radio":this.checked&&e.getModel().set(this.name,this.value);break;case"checkbox":e.getModel().set(this.name,this.checked?"1":"0");break;case"field":e.getModel().set(this.name,this.getValue());break;default:e.getModel().set(this.name,this.value)}},"SELECT"==this.tagName&&(this.onmouseup=function(){e.getModel().set(this.name,this.value)}),this.name=this.dataset.selfProperty,this.removeAttribute("data-self-property"),this._list_property.push(this)),this._list_watch=this._list_watch.filter(t=>null!=t.parentElement),n!=this._list_watch.length&&(i=!0),this._list_visible=this._list_visible.filter(t=>null!=t.parentElement),r!=this._list_visible.length&&(i=!0),this._list_property=this._list_property.filter(t=>null!=t.parentElement),o!=this._list_property.length&&(i=!0),null!=this.model&&i&&this.model.setNamespace(this.eid).update(!0).setNamespace(null)},onCreated:function(){},onConnected:function(){},onDisconnected:function(){},onRefAdded:function(t){},onRefRemoved:function(t){},onModelPreChanged:function(t,e){let i=this.getModel().get();for(let s=0;s<this._list_watch.length;s++)for(let t of e.fields)if(this._list_watch[s]._watch.test(t)){this._list_watch[s].innerHTML=this._list_watch[s]._template(i);break}for(let s=0;s<this._list_visible.length;s++)this._list_visible[s]._visible(i,"arg")?this._list_visible[s].style.display="block":this._list_visible[s].style.display="none";this.onModelChanged(t,e)},onModelChanged:function(t,e){},onModelPropertyChanging:function(t,e){},onModelPropertyPreChanged:function(t,e){for(let i=0;i<this._list_property.length;i++)if(this._list_property[i].name==e.name){let t=!0;switch(this._list_property[i].type){case"radio":if(this._list_property[i].value!=e.value){this._list_property[i].parentElement.classList.remove("active");continue}this._list_property[i].checked=!0,this._list_property[i].parentElement.classList.add("active");break;case"checkbox":~~e.value?(this._list_property[i].checked=!0,this._list_property[i].parentElement.classList.add("active")):(this._list_property[i].checked=!1,this._list_property[i].parentElement.classList.remove("active"));break;case"field":this._list_property[i].setValue(e.value),t=!1;break;default:this._list_property[i].value=e.value,this._list_property[i]._value=e.value,this._list_property[i].value!=e.value&&(t=!1)}t&&this._list_property[i].onchange&&this._list_property[i].onchange()}this.onModelPropertyChanged(t,e)},onModelPropertyChanged:function(t,e){this.dispatch("propertyChanged."+e.name,e,!1),this.dispatch("propertyChanged",e,!1)},onModelPropertyRemoved:function(t,e){},preparePrototype:function(t){if(!0!==t.__prototypePrepared){t.__prototypePrepared=!0,"events"in t||(t.events={});for(let e in t)e.startsWith("event ")&&(t.events[e.substr(6)]=t[e],delete t[e])}},register:function(t,...i){var s=class extends HTMLElement{constructor(){super(),this.invokeConstructor=!0,this._super={};for(let t of Object.entries(this.constructor.prototype._super)){this._super[t[0]]={};for(let e of Object.entries(t[1]))this._super[t[0]][e[0]]=e[1].bind(this)}this.onCreated()}findRoot(t){let e=t||this.parentElement;for(;null!=e;){if("isRoot"in e&&e.isRoot)return e;e=e.parentElement}return null}findCustomParent(t){let e=t?t.parentElement:this.parentElement;for(;null!=e;){if("true"==e.dataset._custom)return e;e=e.parentElement}return null}connectReference(t=null,e=255){this.root||1!=(1&e)||(null==t&&(t=this.findRoot()),null!=t?(this.dataset.ref&&(t[this.dataset.ref]=this,t.refs[this.dataset.ref]=this),delete this.dataset._pending,this.dataset._linked="true",this.root=t):this.dataset._pending="true"),this.root&&2==(2&e)&&this.dataset.ref&&this.root.onRefAdded(this.dataset.ref)}connectedCallback(){this.connectReference(null,1),this.invokeConstructor&&(this.invokeConstructor=!1,this.dataset._custom="true",this.__ctor()),this.connectReference(null,2),this.onConnected(),this.dataset.xref&&(globalThis[this.dataset.xref]=this)}disconnectedCallback(){this.root&&(this.dataset.ref&&(this.root.onRefRemoved(this.dataset.ref),delete this.root[this.dataset.ref],delete this.root.refs[this.dataset.ref]),delete this.dataset._pending,this.dataset._linked="false",this.root=null),this.onDisconnected(),this.dataset.xref&&delete globalThis[this.dataset.xref]}};e.override(s.prototype,o);const l={},a={},h=e.clone(o.events);for(let r=0;r<i.length;r++)if(i[r]){if("string"==e.typeOf(i[r])){const t=i[r];if(i[r]=n[t],!i[r])continue;a[t]={};for(let s in i[r])"function"==e.typeOf(i[r][s])&&(a[t][s]=i[r][s])}else o.preparePrototype(i[r]);"_super"in i[r]&&e.override(a,i[r]._super),"events"in i[r]&&e.override(h,i[r].events),e.override(s.prototype,i[r]),e.override(l,i[r])}return s.prototype._super=a,s.prototype.events=h,l._super=a,l.events=h,customElements.define(t,s),n[t]=l,r[t]=s,s},expand:function(t,...i){if(!(t in n))return;const s=n[t],l=r[t],a=s._super,h=s.events;for(let n of i)o.preparePrototype(n),"_super"in n&&e.override(a,n._super),"events"in n&&e.override(h,n.events),e.override(l.prototype,n),e.override(s,n);l.prototype._super=a,l.prototype.events=h,s._super=a,s.events=a},":toggleClass":function(t,e){let i=e.source;"2"in t&&(i=document.querySelector(t[2])),i&&(i.classList.contains(t[1])?i.classList.remove(t[1]):i.classList.add(t[1]))}};o.register("r-elem",{});
},{"@rsthn/rin":"MJTl"}],"SJdT":[function(require,module,exports) {
var global = arguments[3];
var define;
var e,t=arguments[3];!function(r){var o="object"==typeof exports&&exports,a="object"==typeof module&&module&&module.exports==o&&module,n="object"==typeof t&&t;n.global!==n&&n.window!==n||(r=n);var c=function(e){this.message=e};(c.prototype=new Error).name="InvalidCharacterError";var h=function(e){throw new c(e)},d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=/[\t\n\f\r ]/g,s={encode:function(e){e=String(e),/[^\0-\xFF]/.test(e)&&h("The string to be encoded contains characters outside of the Latin1 range.");for(var t,r,o,a,n=e.length%3,c="",i=-1,s=e.length-n;++i<s;)t=e.charCodeAt(i)<<16,r=e.charCodeAt(++i)<<8,o=e.charCodeAt(++i),c+=d.charAt((a=t+r+o)>>18&63)+d.charAt(a>>12&63)+d.charAt(a>>6&63)+d.charAt(63&a);return 2==n?(t=e.charCodeAt(i)<<8,r=e.charCodeAt(++i),c+=d.charAt((a=t+r)>>10)+d.charAt(a>>4&63)+d.charAt(a<<2&63)+"="):1==n&&(a=e.charCodeAt(i),c+=d.charAt(a>>2)+d.charAt(a<<4&63)+"=="),c},decode:function(e){var t=(e=String(e).replace(i,"")).length;t%4==0&&(t=(e=e.replace(/==?$/,"")).length),(t%4==1||/[^+a-zA-Z0-9/]/.test(e))&&h("Invalid character: the string to be decoded is not correctly encoded.");for(var r,o,a=0,n="",c=-1;++c<t;)o=d.indexOf(e.charAt(c)),r=a%4?64*r+o:o,a++%4&&(n+=String.fromCharCode(255&r>>(-2*a&6)));return n},version:"1.0.0"};if("function"==typeof e&&"object"==typeof e.amd&&e.amd)e(function(){return s});else if(o&&!o.nodeType)if(a)a.exports=s;else for(var f in s)s.hasOwnProperty(f)&&(o[f]=s[f]);else r.base64=s}(this);
},{}],"z2hx":[function(require,module,exports) {

"use strict";var e=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t)return t;throw new Error("unable to locate global object")},t=e();module.exports=exports=t.fetch,t.fetch&&(exports.default=t.fetch.bind(t)),exports.Headers=t.Headers,exports.Request=t.Request,exports.Response=t.Response;
},{}],"LVu9":[function(require,module,exports) {
var global = arguments[3];
var e=arguments[3];const t=require("base-64");"fetch"in e||(e.fetch=require("node-fetch")),module.exports={apiUrl:"/api",useReq64:!1,retries:1,_requestLevel:0,_requestPackage:0,_packageData:[],setEndPoint:function(e){this.apiUrl=e},responseFilter:function(e,t){return!0},packageBegin:function(){this._requestPackage++},packageEnd:function(){this._requestPackage&&(--this._requestPackage||this.packageSend())},packRequests:function(e){this.packageBegin(),e(),this.packageEnd()},packageSend:function(){if(!this._packageData.length)return;let e=this._packageData;this._packageData=[];for(var n="",a=0;a<e.length;a++)n+="r"+a+","+t.encode(this.encodeParams(e[a][2]))+";";this._showProgress(),this.apiCall({rpkg:n},(t,n)=>{for(let s=0;s<e.length;s++)try{var a=t["r"+s];if(!a){null!=e[s][1]&&e[s][1](e[s][2]);continue}null!=e[s][0]&&this.responseFilter(a,e[s][2])&&e[s][0](a,e[s][2])}catch(i){}},t=>{for(let n=0;n<e.length;n++)null!=e[n][1]&&e[n][1](e[n][2])})},_showProgress:function(){"document"in e&&(this._requestLevel++,this._requestLevel>0&&e.document.documentElement.classList.add("busy"))},_hideProgress:function(){"document"in e&&(this._requestLevel--,this._requestLevel||e.document.documentElement.classList.remove("busy"))},encodeParams:function(e){let t=[];if(e instanceof FormData)for(let n of e.entries())t.push(encodeURIComponent(n[0])+"="+encodeURIComponent(n[1]));else for(let n in e)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")},apiCall:function(n,a,i,s,o){let r=this.apiUrl+"?_="+Date.now();if("GET"!=s&&"POST"!=s&&(s="auto"),void 0===o&&(o=this.retries),this._requestPackage)return n instanceof FormData||(n={...n}),void this._packageData.push([a,i,n]);this._showProgress();let c=n,l={credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"text/html,application/xhtml+xml,application/xml,application/json;q=0.9"},method:s,body:null,multipart:!1};if(!(c instanceof FormData)){c=new FormData;for(let e in n)c.append(e,n[e])}for(let e of c.entries())if(e[1]instanceof File||e[1]instanceof Blob){l.method="POST",l.headers["Content-Type"]="multipart/form-data",l.multipart=!0;break}if(this.useReq64&&!l.multipart){let e=new FormData;e.append("req64",t.encode(this.encodeParams(c))),c=e}if("auto"==l.method){let e=0;l.method="GET";for(let t of c.entries())if((e+=t[0].length+t[1].length+2)>960){l.method="POST";break}}"GET"==l.method?r+="&"+this.encodeParams(c):l.multipart?l.body=c:l.body=this.encodeParams(c),e.fetch(r,l).then(e=>e.json()).then(e=>{if(this._hideProgress(),a&&this.responseFilter(e,n))try{a(e,n)}catch(t){}}).catch(e=>{this._hideProgress(),0==o?i&&i(n):this.apiCall(c,a,i,s,o-1)})},post:function(e,t,n){return this.apiCall(e,t,n,"POST")},get:function(e,t,n){return this.apiCall(e,t,n,"GET")},fetch:function(e){return new Promise((t,n)=>{this.apiCall(e,t,n)})}};
},{"base-64":"SJdT","node-fetch":"z2hx"}],"rn2q":[function(require,module,exports) {
const{Model:t,ModelList:e,EventDispatcher:i}=require("@rsthn/rin"),s=require("./api");module.exports=i.extend({className:"DataSource",debounceDelay:250,request:null,includeCount:!1,includeEnum:!1,includeList:!0,eid:null,count:0,list:null,enum:null,__ctor:function(i,s){this._super.EventDispatcher.__ctor(),this.basePath=i,this.request=new t,s&&Rin.override(this,s),this.eid=Math.random().toString().substr(2),this.count=0,this.list=new e,this.list.dataSource=this,this.enum=new e,this.enum.dataSource=this,this.request.addEventListener(this.eid+":propertyChanged",this.forwardRequestEvent,this),this.list.addEventListener(this.eid+":itemsCleared",this.forwardListEvent,this),this.list.addEventListener(this.eid+":itemsChanged",this.forwardListEvent,this),this.list.addEventListener(this.eid+":itemRemoved",this.forwardListEvent,this),this.list.addEventListener(this.eid+":itemChanged",this.forwardListEvent,this),this.list.addEventListener(this.eid+":itemAdded",this.forwardListEvent,this),this.enum.addEventListener(this.eid+":itemsCleared",this.forwardEnumEvent,this),this.enum.addEventListener(this.eid+":itemsChanged",this.forwardEnumEvent,this),this.enum.addEventListener(this.eid+":itemRemoved",this.forwardEnumEvent,this),this.enum.addEventListener(this.eid+":itemChanged",this.forwardEnumEvent,this),this.enum.addEventListener(this.eid+":itemAdded",this.forwardEnumEvent,this)},forwardRequestEvent:function(t,e){this.prepareEvent("request"+t.name[0].toUpperCase()+t.name.substr(1),e).setSource(t.source).resume()},forwardListEvent:function(t,e){this.prepareEvent("list"+t.name[0].toUpperCase()+t.name.substr(1),e).setSource(t.source).resume()},forwardEnumEvent:function(t,e){this.prepareEvent("enum"+t.name[0].toUpperCase()+t.name.substr(1),e).setSource(t.source).resume()},refresh:function(t="full"){this._timeout&&(clearTimeout(this._timeout),this._timeout=null),this._timeout=setTimeout(()=>{this._timeout=null;let e=(this.includeCount&&("full"==t||"filter"==t))+(this.includeEnum&&"full"==t)+this.includeList;e>1&&s.packageBegin(),!this.includeCount||"full"!=t&&"filter"!=t||this.fetchCount(),this.includeEnum&&"full"==t&&this.fetchEnum(),this.includeList&&this.fetchList(),e>1&&s.packageEnd()},this.debounceDelay)},fetch:function(t,e=!1){return new Promise((i,s)=>{let n=1==e?null:this.list.find(t,!0);n?i(n.get()):this.fetchOne(t,t=>{t&&200==t.response?t.data.length>0?i(t.data[0],t):s(null):s(t.error)})})},delete:function(t){return new Promise((e,i)=>{this.fetchDelete(t,t=>{200==t.response?e(t):i(t.error)})})},fetchList:function(){let t={...this.request.get()};t.f=this.basePath+".list",s.fetch(t).then(t=>{this.list.setData(200==t.response?t.data:null),this.dispatchEvent("listChanged")})},fetchEnum:function(){let t={...this.request.get()};t.f=this.basePath+".enum",s.fetch(t).then(t=>{this.enum.setData(200==t.response?t.data:null),this.dispatchEvent("enumChanged")})},fetchCount:function(){let t={...this.request.get()};t.f=this.basePath+".count",s.fetch(t).then(t=>{this.count=200==t.response?t.count:0,this.dispatchEvent("countChanged")})},fetchOne:function(t,e){let i={...this.request.get(),...t};i.f=this.basePath+".get",s.fetch(i).then(t=>{e(t)})},fetchDelete:function(t,e){let i={...this.request.get(),...t};i.f=this.basePath+".delete",s.fetch(i).then(t=>{e(t)})}});
},{"@rsthn/rin":"MJTl","./api":"LVu9"}],"eKHE":[function(require,module,exports) {
let t=require("../element"),e=require("../router");t.register("r-tabs",{events:{"click [data-name]":function(t){t.continuePropagation=!0,this.dataset.baseRoute?window.location="#"+this.dataset.baseRoute.replace("@",t.source.dataset.name):this.selectTab(t.source.dataset.name)}},init:function(){this._routeHandler=((t,e)=>{e.route.changed&&this._showTab(e.tabName)})},ready:function(){"container"in this.dataset?this.container=document.querySelector(this.dataset.container):this.container=this.nextElementSibling,this._hideTabsExcept(null)},onConnected:function(){this.dataset.baseRoute&&e.addRoute(this.dataset.baseRoute.replace("@",":tabName"),this._routeHandler)},onDisconnected:function(){this.dataset.baseRoute&&e.removeRoute(this.dataset.baseRoute.replace("@",":tabName"),this._routeHandler)},_hideTabsExcept:function(t){null!=this.container&&(t||(t=""),this.container.querySelectorAll(":scope > [data-name]").forEach(e=>{e.dataset.name==t?(e.classList.contains("x-hidden")&&this.dispatch("tab-activate",{name:e.dataset.name,el:e}),e.classList.remove("x-hidden")):(e.classList.contains("x-hidden")||this.dispatch("tab-deactivate",{name:e.dataset.name,el:e}),e.classList.add("x-hidden"))}),this.querySelectorAll("[data-name]").forEach(e=>{e.dataset.name==t?e.classList.add("active"):e.classList.remove("active")}))},_showTab:function(t){return this._hideTabsExcept(t)},selectTab:function(t){if(this.dataset.baseRoute){const e="#"+this.dataset.baseRoute.replace("@",t);if(window.location.hash!=e)return void(window.location=e)}this._showTab(t)}});
},{"../element":"yFRv","../router":"hPM2"}],"aahd":[function(require,module,exports) {
const{Rin:e}=require("@rsthn/rin"),t=require("../element"),s=require("../api");t.register("r-form",{events:{"change [data-field]":"_fieldChanged","click input[type=reset]":"reset","click .reset":"reset","click input[type=submit]":"submit","click button[type=submit]":"submit","click .submit":"submit","submit form":"submit"},init:function(){this.setModel({})},ready:function(){let e={},t={};this.querySelectorAll("[data-field]").forEach(s=>{s.name=s.dataset.field,t[s.name]=s.type;let i=s.dataset.default;if(null==i)switch(s.type){case"radio":if(!s.checked)return;i=s.value;break;case"checkbox":i=s.checked?"1":"0";break;case"file":default:i=""}e[s.dataset.field]=i});for(let s in t)t[s]=s in e?e[s]:"";e=t,this.model.defaults=e,this.model.reset(),this._clearMarkers()},filterString:function(e,t){return e},_change:function(e){if("createEvent"in document){let t=document.createEvent("HTMLEvents");t.initEvent("change",!1,!0),e.dispatchEvent(t)}else e.fireEvent("onchange")},_setField:function(e,t,s){if(e)for(e of this.querySelectorAll('[data-field="'+e+'"]'))switch(e.type||e.tagName.toLowerCase()){case"select":e.dataset.value=e.multiple&&t?t.split(","):t,e.value=e.dataset.value,!0!==s&&this._change(e);break;case"checkbox":e.checked=!!parseInt(t);break;case"radio":e.checked=t==e.value;break;case"file":t instanceof File||t instanceof Blob?e.dataset.value=t:t instanceof FileList?e.dataset.value=t:(e.dataset.value="",e.value="");break;default:e.dataset.value=t,e.value=t,!0!==s&&this._change(e)}},_getField:function(e){let t=null==e.value?e.dataset.value:e.value;switch(e.type||e.tagName.toLowerCase()){case"select":t=e.multiple&&t?t.join(","):t;break;case"checkbox":t=e.checked?"1":"0";break;case"file":t=e.files&&e.files.length?e.multiple?e.files:e.files[0]:null}return t},_clearMarkers:function(){this.classList.remove("busy"),this.querySelectorAll(".message, .loading-indicator").forEach(e=>e.classList.add("x-hidden")),this.querySelectorAll("span.field-error").forEach(e=>e.remove()),this.querySelectorAll(".field-error").forEach(e=>{e.classList.remove("field-error"),e.classList.remove("is-invalid")}),this.querySelectorAll(".field-passed").forEach(e=>e.classList.remove("field-passed"))},_fieldChanged:function(e){let t=e.source;"file"==t.type?this.model.set(t.dataset.field,this._getField(t),!0):this.model.set(t.dataset.field,this._getField(t)),e.continuePropagation=!0},_onSuccess:function(e){this.classList.remove("busy");let t=this.querySelector(".loading-indicator");t&&t.classList.add("x-hidden"),this.dispatch("formSuccess",e),e.message&&null!=(t=this.querySelector(".message.success"))&&(t.innerHTML=this.filterString(e.message,e),t.classList.remove("x-hidden"))},_onFailure:function(e){this.classList.remove("busy");let t=this.querySelector(".loading-indicator");if(t&&t.classList.add("x-hidden"),this.dispatch("formError",e),e.fields){for(let s in e.fields){let i=this.querySelector('[data-field-container="'+s+'"]');(i||(i=this.querySelector('[data-field="'+s+'"]')))&&((t=document.createElement("span")).classList.add("field-error"),t.innerHTML=this.filterString(e.fields[s],e),i.classList.add("field-error"),i.classList.add("is-invalid"),"bottom"==this.dataset.errorsAt?i.parentElement.append(t):"top"==this.dataset.errorsAt?i.parentElement.prepend(t):i.parentElement.insertBefore(t,i.nextElementSibling),setTimeout(function(e){return function(){e.classList.add("active")}}(t),25))}e.error&&null!=(t=this.querySelector(".message.error"))&&(t.innerHTML=this.filterString(e.error,e),t.classList.remove("x-hidden"))}else null!=(t=this.querySelector(".message.error"))&&(t.innerHTML=this.filterString(e.error,e)||"Error: "+e.response,t.classList.remove("x-hidden"))},onModelPropertyChanged:function(e,t){this._setField(t.name,t.value)},reset:function(e){if(this.model.reset(e),this._clearMarkers(),!1===e)for(var t in this.model.data)this._setField(t,this.model.data[t],!0);return!1},submit:function(){if(this.classList.contains("busy"))return;let e=this.model.get("false"!=this.dataset.strict),t=this.dataset.formAction||this.formAction;if(!t)return;this._clearMarkers(),this.classList.add("busy");let i=this.querySelector(".loading-indicator");i&&i.classList.remove("x-hidden"),"function"!=typeof t?(e.f=t,s.apiCall(e,e=>this[200==e.response?"_onSuccess":"_onFailure"](e),e=>this._onFailure({error:"Unable to execute request."}))):t(e,e=>this[200==e.response?"_onSuccess":"_onFailure"](e))}});
},{"@rsthn/rin":"MJTl","../element":"yFRv","../api":"LVu9"}],"bgTB":[function(require,module,exports) {
let t=require("../element"),e=require("../router");t.register("r-panel",{events:{},init:function(){this._onActivate=((t,e)=>{e.route.changed&&this.show(!0)}),this._onDeactivate=((t,e)=>{this.hide()}),this.hide()},ready:function(){},onConnected:function(){this.dataset.route&&e.addRoute(this.dataset.route,this._onActivate,this._onDeactivate)},onDisconnected:function(){this.dataset.route&&e.removeRoute(this.dataset.route,this._onActivate,this._onDeactivate)},hide:function(){this.classList.remove("active"),this.dispatch("panelHidden",{})},show:function(t=!1){if(this.dataset.route&&!t){let t="#"+this.dataset.route;if(window.location.hash.substr(0,t.length)!=t)return void(window.location=t)}this.classList.add("active"),this.dispatch("panelShown",{})}});
},{"../element":"yFRv","../router":"hPM2"}],"mVSt":[function(require,module,exports) {
const{Rin:t,ModelList:e,Template:i}=require("@rsthn/rin");let s=require("../element");s.register("r-list",{list:null,container:null,template:null,isEmpty:!1,isDynamic:!1,init:function(){this.container=this.querySelector(this.dataset.container||".x-data"),this.container||(this.container=this);let t=this.querySelector("template");t?("dynamic"!=t.dataset.mode?this.template=i.compile(t.innerHTML):(this.template=(()=>t.innerHTML),this.isDynamic=!0),t.remove()):this.template=(()=>""),this.container.textContent=" ",this.setEmpty(!0)},rready:function(){let t=this.getFieldByPath(this.dataset.list);t?this.setList(t):console.error("List not found: "+this.dataset.list)},setEmpty:function(t){this.isEmpty!==t&&(t?(this.querySelectorAll(".x-empty").forEach(t=>t.classList.remove("x-hidden")),this.querySelectorAll(".x-not-empty").forEach(t=>t.classList.add("x-hidden"))):(this.querySelectorAll(".x-empty").forEach(t=>t.classList.add("x-hidden")),this.querySelectorAll(".x-not-empty").forEach(t=>t.classList.remove("x-hidden"))),this.isEmpty=t)},setList:function(i){i&&t.isTypeOf(e,i)&&this.list!==i&&(null!=this.list&&this.list.removeEventListener(this.eid+":*"),this.list=i,this.list.addEventListener(this.eid+":itemsCleared",this.onItemsCleared,this),this.list.addEventListener(this.eid+":itemsChanged",this.onItemsChanged,this),this.list.addEventListener(this.eid+":itemRemoved",this.onItemRemoved,this),this.list.addEventListener(this.eid+":itemChanged",this.onItemChanged,this),this.list.addEventListener(this.eid+":itemAdded",this.onItemAdded,this))},buildItem:function(t,e){let i=document.createElement("div");return i.dataset.iid=t,i.innerHTML=this.template(e.get()),i.querySelectorAll('[data-model=":list-item"]').forEach(t=>{t.model=e,t.dataset.model="this.model"}),i},onItemsCleared:function(t,e){this.container._timeout=setTimeout(()=>{this.setEmpty(!0),this.container._timeout=null,this.container.textContent=""},300)},onItemsChanged:function(t,e){if(0==this.list.length())return;this.container._timeout&&clearTimeout(this.container._timeout),this.container._timeout=null,this.container.textContent="";let i=0;for(let s of this.list.getData())this.container.append(this.buildItem(this.list.itemId[i++],s));this.setEmpty(0==i)},onItemRemoved:function(t,e){let i=this.container.querySelector('[data-iid="'+e.id+'"]');i&&(i.remove(),this.setEmpty(0==this.list.length()))},onItemChanged:function(t,e){if(this.isDynamic)return;let i=this.container.querySelector('[data-iid="'+e.id+'"]');i&&(i.innerHTML=this.template(e.item))},onItemAdded:function(t,e){"head"==e.position?this.container.prepend(this.buildItem(e.id,e.item)):this.container.append(this.buildItem(e.id,e.item)),this.setEmpty(!1)}});
},{"@rsthn/rin":"MJTl","../element":"yFRv"}],"i8YR":[function(require,module,exports) {
let e=require("../element");e.register("r-item",{init:function(){},rready:function(){let e=this.getFieldByPath(this.dataset.model);e&&this.setModel(e)}});
},{"../element":"yFRv"}],"otkn":[function(require,module,exports) {
const{Rin:e}=require("@rsthn/rin");let t=require("../element"),s=require("../data-source");t.register("r-paginator",{source:null,template:null,init:function(){this.setModel({offsetStart:0,offsetEnd:0,count:0,offset:0,currentPageSize:this.dataset.pageSize||25,pageSize:this.dataset.pageSize||25}),this.listen("propertyChanged.pageSize",(e,t)=>{this.model.get("currentPageSize")!=t.value&&(this.model.set("currentPageSize",t.value),this.updateOffset("range"))})},rready:function(){let e=this.getFieldByPath(this.dataset.source);e?this.setSource(e):console.error("data-source not found: "+this.dataset.source)},setSource:function(t){t&&e.isTypeOf(s,t)&&this.source!==t&&(null!=this.source&&(this.source.removeEventListener(this.eid+":*"),this.source.includeCount=!1),this.source=t,this.source.includeCount=!0,this.updateOffset("full"),this.source.addEventListener(this.eid+":countChanged",this.onCountChanged,this),this.source.addEventListener(this.eid+":listItemRemoved",this.onItemRemoved,this),this.source.addEventListener(this.eid+":listItemAdded",this.onItemAdded,this))},updateOffset:function(e=null){this.model.set("offsetStart",0!=this.model.get("count")?this.model.get("offset")+1:0),this.model.set("offsetEnd",Math.min(this.model.get("count"),this.model.get("offsetStart")+this.model.getInt("pageSize")-1)),this.model.update("count");let t=this.source.request.get("count"),s=this.source.request.get("offset");this.source.request.set("count",this.model.getInt("pageSize")),this.source.request.set("offset",this.model.get("offset")),!e||t==this.source.request.get("count")&&s==this.source.request.get("offset")||this.source.refresh(e)},onCountChanged:function(e,t){this.model.set("count",e.source.count,!1),this.updateOffset()},onItemRemoved:function(e,t){this.model.set("count",this.model.getInt("count")-1,!1),this.updateOffset()},onItemAdded:function(e,t){this.model.set("count",this.model.getInt("count")+1,!1),this.updateOffset()},prevPage:function(){if(this.model.get("offset")<=0)return;let e=this.model.get("offset")-this.model.getInt("pageSize");e<0&&(e=0),this.model.set("offset",e),this.updateOffset("range")},nextPage:function(){let e=this.model.get("offset")+this.model.getInt("pageSize");e>=this.model.get("count")||(this.model.set("offset",e),this.updateOffset("range"))},firstPage:function(){this.model.set("offset",0),this.updateOffset("range")},lastPage:function(){let e=this.model.get("count")-this.model.getInt("pageSize");e<0&&(e=0),this.model.set("offset",e),this.updateOffset("range")},refresh:function(){this.source.refresh("full")}});
},{"@rsthn/rin":"MJTl","../element":"yFRv","../data-source":"rn2q"}],"gfy4":[function(require,module,exports) {
const{Rin:e,Template:t}=require("@rsthn/rin");let s=require("../element"),r=require("../data-source");s.register("r-table",{source:null,template:null,container:null,isEmpty:null,init:function(){this.setModel({})},ready:function(){if(this.container=this.querySelector(this.dataset.container||"tbody.x-data"),!this.container)throw new Error("r-table requires a container");"dynamic"!=this.container.dataset.mode?this.template=t.compile(this.container.innerHTML):this.template=(()=>this.container.innerHTML),this.temporalBody=document.createElement("tbody"),this.container.textContent=" ",this.setEmpty(!0)},rready:function(){let e=this.getFieldByPath(this.dataset.source);e?this.setSource(e):console.error("data-source not found: "+this.dataset.source)},setEmpty:function(e){this.isEmpty!==e&&(e?(this.querySelectorAll(".x-empty").forEach(e=>e.classList.remove("x-hidden")),this.querySelectorAll(".x-not-empty").forEach(e=>e.classList.add("x-hidden"))):(this.querySelectorAll(".x-empty").forEach(e=>e.classList.add("x-hidden")),this.querySelectorAll(".x-not-empty").forEach(e=>e.classList.remove("x-hidden"))),this.isEmpty=e)},setSource:function(t){t&&e.isTypeOf(r,t)&&this.source!==t&&(null!=this.source&&this.source.removeEventListener(this.eid+":*"),this.source=t,this.source.addEventListener(this.eid+":requestPropertyChanged",this.onRequestPropertyChanged,this),this.source.addEventListener(this.eid+":listItemsCleared",this.onItemsCleared,this),this.source.addEventListener(this.eid+":listItemsChanged",this.onItemsChanged,this),this.source.addEventListener(this.eid+":listItemRemoved",this.onItemRemoved,this),this.source.addEventListener(this.eid+":listItemChanged",this.onItemChanged,this),this.source.addEventListener(this.eid+":listItemAdded",this.onItemAdded,this))},onRequestPropertyChanged:function(e,t){if(this.model.set(t.name,t.value),"sort"==t.name)this.querySelectorAll("thead [data-sort]").forEach(e=>e.dataset.order="");else if("order"==t.name){let s=this.querySelector('thead [data-sort="'+e.source.get("sort")+'"]');s&&(s.dataset.order=t.value)}},onModelPropertyChanged:function(e,t){this.source.request.set(t.name,t.value),this.source.refresh("filter")},onModelPropertyRemoved:function(e,t){"string"==typeof t.fields?this.source.request.remove(i):t.fields.forEach(e=>this.source.request.remove(e)),this.source.refresh("filter")},buildItem:function(e,t){let s=this.temporalBody;return s.innerHTML=this.template(t.get()),s.querySelectorAll('[data-model=":list-item"]').forEach(e=>{e.model=t,e.dataset.model="this.model"}),(s=s.firstElementChild).dataset.iid=e,s},onItemsCleared:function(e,t){this.container._timeout=setTimeout(()=>{this.setEmpty(!0),this.container._timeout=null,this.container.textContent=""},300)},onItemsChanged:function(e,t){if(0==this.source.list.length())return;this.container._timeout&&clearTimeout(this.container._timeout),this.container._timeout=null,this.container.textContent="";let s=0;for(let i of this.source.list.getData())this.container.append(this.buildItem(this.source.list.itemId[s++],i));this.setEmpty(0==s)},onItemRemoved:function(e,t){let s=this.container.querySelector('[data-iid="'+t.id+'"]');s&&(s.remove(),this.setEmpty(0==this.source.list.length()))},onItemChanged:function(e,t){let s=this.container.querySelector('[data-iid="'+t.id+'"]');if(!s)return;let i=this.buildItem(t.id,t.item);this.container.replaceChild(i,s)},onItemAdded:function(e,t){"head"==t.position?this.container.prepend(this.buildItem(t.id,t.item)):this.container.append(this.buildItem(t.id,t.item)),this.setEmpty(!1)},"event click thead [data-sort]":function(e,t){this.source.request.get("sort")==e.source.dataset.sort?(this.source.request.set("order","asc"==this.source.request.get("order")?"desc":"asc"),this.source.refresh("order")):(this.source.request.set("sort",e.source.dataset.sort),this.source.request.set("order","asc",!0),this.source.refresh("order"))}});
},{"@rsthn/rin":"MJTl","../element":"yFRv","../data-source":"rn2q"}],"PfF3":[function(require,module,exports) {
const{Rin:t,ModelList:e}=require("@rsthn/rin");let i=require("../element");i.register("r-select",{list:null,container:null,init:function(){this.container=document.createElement("select"),this.parentElement.insertBefore(this.container,this);for(let t of this.attributes)t.nodeName.startsWith("data-_")||"data-list"==t.nodeName||"data-blank"==t.nodeName||this.container.setAttribute(t.nodeName,t.nodeValue);this.textContent=" ",this.style.display="none"},rready:function(){let t=this.getFieldByPath(this.dataset.list);t?this.setList(t):console.error("List not found: "+this.dataset.list)},setList:function(i){i&&t.isTypeOf(e,i)&&this.list!==i&&(null!=this.list&&this.list.removeEventListener(this.eid+":*"),this.list=i,this.list.dataSource&&(this.list.dataSource.includeEnum=!0),this.list.addEventListener(this.eid+":itemsCleared",this.onItemsCleared,this),this.list.addEventListener(this.eid+":itemsChanged",this.onItemsChanged,this),this.list.addEventListener(this.eid+":itemRemoved",this.onItemsChanged,this),this.list.addEventListener(this.eid+":itemChanged",this.onItemsChanged,this),this.list.addEventListener(this.eid+":itemAdded",this.onItemsChanged,this))},onItemsCleared:function(t,e){this.container.textContent=""},onItemsChanged:function(t,e){if(0==this.list.length())return;let i,s,n=this.list.getData(),a="";n[0].has("value")?i="value":n[0].has("id")&&(i="id"),n[0].has("label")?s="label":n[0].has("name")&&(s="name"),"blank"in this.dataset&&(a+='<option value="">'+this.dataset.blank+"</option>"),n.forEach(t=>a+='<option value="'+t.get(i)+'">'+t.get(s)+"</option>"),this.container.innerHTML=a,this.container._value!=this.container.value&&(this.container.value=this.container._value,this.dispatchOn(this.container,"change"))}});
},{"@rsthn/rin":"MJTl","../element":"yFRv"}],"uIMb":[function(require,module,exports) {
module.exports={Tabs:require("./elems/r-tabs"),Form:require("./elems/r-form"),Panel:require("./elems/r-panel"),List:require("./elems/r-list"),Item:require("./elems/r-item"),Paginator:require("./elems/r-paginator"),Table:require("./elems/r-table"),Select:require("./elems/r-select")};
},{"./elems/r-tabs":"eKHE","./elems/r-form":"aahd","./elems/r-panel":"bgTB","./elems/r-list":"mVSt","./elems/r-item":"i8YR","./elems/r-paginator":"otkn","./elems/r-table":"gfy4","./elems/r-select":"PfF3"}],"epB2":[function(require,module,exports) {
module.exports={rin:require("@rsthn/rin"),Router:require("./router"),Element:require("./element"),Api:require("./api"),DataSource:require("./data-source"),Elements:require("./elements")};
},{"@rsthn/rin":"MJTl","./router":"hPM2","./element":"yFRv","./api":"LVu9","./data-source":"rn2q","./elements":"uIMb"}]},{},["epB2"], "rfront")
//# sourceMappingURL=/rin-front.js.map